#Halation v2.8
#by silly calvin
#2021
#https://twitter.com/ALVY_aaa/
Gizmo {
 inputs 3
 knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\n\nglow = nuke.thisNode()\['glow'].value()\nswitchYes = nuke.toNode('Switch2')\['which'].value()\n\nnum = nuke.toNode('Reformat1')\['sumBox'].value()\ninputWidth = nuke.toNode('Reformat1')\['inputWidth'].value()\ninputHeight = nuke.toNode('Reformat1')\['inputHeight'].value()\n\ndef isPrime(n) :\n    if (n <= 1) :\n        return False\n    if (n <= 3) :\n        return True\n    if (n % 2 == 0 or n % 3 == 0) :\n        return False\n    i = 5\n    while(i * i <= n) :\n        if (n % i == 0 or n % (i + 2) == 0) :\n            return False\n        i = i + 6\n        return True\n\nif (isPrime(num)) :\n    nuke.toNode('Reformat1').knob('box_width').setValue(inputWidth)\n    nuke.toNode('Reformat1').knob('box_height').setValue(inputHeight + 1)\nelse:\n     nuke.toNode('Reformat1').knob('box_width').setValue(inputWidth)\n     nuke.toNode('Reformat1').knob('box_height').setValue(inputHeight)\n\nif glow == 0:\n    n\[\"glow_intensity\"].setEnabled(False)\n    n\[\"glow_radius\"].setEnabled(False)\n    n\[\"glow_falloff\"].setEnabled(False)\n    n\[\"_1\"].setEnabled(False)\n    n\[\"_7\"].setEnabled(False)\n    n\[\"_8\"].setEnabled(False)\n    n\[\"_9\"].setEnabled(False)\nelse:\n    n\[\"glow_intensity\"].setEnabled(True)\n    n\[\"glow_radius\"].setEnabled(True)\n    n\[\"glow_falloff\"].setEnabled(True)\n    n\[\"_1\"].setEnabled(True)\n    n\[\"_7\"].setEnabled(True)\n    n\[\"_8\"].setEnabled(True)\n    n\[\"_9\"].setEnabled(True)\n\nif switchYes == 2:\n    n\[\"Erode\"].setEnabled(False)\n    n\[\"text_8\"].setEnabled(False)\n    n\[\"soft\"].setEnabled(False)\n    n\[\"_2\"].setEnabled(False)\n    n\[\"greens\"].setEnabled(True)\n    \nelse:\n    n\[\"Erode\"].setEnabled(True)\n    n\[\"text_8\"].setEnabled(True)\n    n\[\"soft\"].setEnabled(True)\n    n\[\"_2\"].setEnabled(True)\n    n\[\"greens\"].setEnabled(False)"
 tile_color 0xff2323ff
 addUserKnob {20 User l Controls}
 addUserKnob {26 Name_and_Credit l "" +STARTLINE T "<font color=#ddd680 size=\"5\">H</font><font color=#ded990 size=\"5\">a</font><font color=#dfdba0 size=\"5\">l</font><font color=#e0ddb0 size=\"5\">a</font><font color=#e1dfc0 size=\"5\">t</font><font color=#e0ddb0 size=\"5\">i</font><font color=#dfdba0 size=\"5\">on</font><font color=#ded990 size=\"3\"> v</font><font color=#ded990 size=\"2\">2.8</font>\n<font color=#ded990 size=\"2\">| by silly calvin</font>"}
 addUserKnob {26 ""}
 addUserKnob {26 text_2 l "" +STARTLINE T "Halation type:   "}
 addUserKnob {22 convolution_method l "<font color=#ded990 size=\"3\">Convolution method</font>" t "Respects values a lot more and it's recommended for a linear workspace with high dynamic footage. I tried tackling the issue in the past of the larger looking halation around stronger light sources and with the Convolution method, it solves this automatically but only if the footage has enough information. So 8-bit footage is unfortunately very bad at this.\n\nThis method comes with a reasonable price though which is the rendering speed and at times is really slow compared to the other ones. \n\n<b>IMPORTANT:</b> Another note though is that unfortunately, this method comes with a few bugs that I have not yet managed to fully fix and seems to be beyond my realm as of now.\n\nOne of them is that depending on the resolution of said footage if the sum of it is a prime number it may sometimes not like it and will introduce severe artifacts that I've semi-fixed as of now by adding a function that checks if it is either a prime number or not and if it is, it adds 1 number to the res and then reformats it back.\n\nAnother bug to keep in mind is that if the footage has too much information i.e values that go over around 50.0 it will introduce severe artifacts but it rarely happens, though can happen if the intensity of the halation is set to 1 or higher. Usually, this means that setting it down to 0 is enough for it since the values are so high. (remember the convolution method does not go by an alpha but rather the values)\n\n<b>Pros:</b>\nRespects the values in a physically correct\nmanner\n\nWorks in ACES\n\nThe most accurate of the 3 methods but at a\ncost of speed in terms of rendering\n\n<b>Cons:</b>\nSlow\n\nNot as much flexibility as the other 2 methods because it's not driven by an alpha but rather values for the benefit of accuracy" -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(2)\n\nnuke.thisNode().knob('convolution_method').setLabel('<font color=#ded990 size=\"3\">Convolution method</font>')\n\nnuke.thisNode().knob('screen_method').setLabel('Screen method')\n\nnuke.thisNode().knob('alpha_method').setLabel('Alpha method')\n\nnuke.thisNode().knob('blur_method').setEnabled(True)\nnuke.thisNode().knob('erode_method').setEnabled(False)\nnuke.thisNode().knob('both').setEnabled(False)\n\nnuke.thisNode().knob('blur_method').setLabel('<font color=#ded990 size=\"3\">Blur method</font>')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('Both')\n"}
 addUserKnob {22 alpha_method l "Alpha method" t "Operatas a bit more smarter than screen method and even though screen method does as well technically use an alpha, I think the name fits since it tries not to touch the highlights as much as screen method does.\n\n<b>Pros:</b>\n Fast\n\n Driven by an alpha for flexibity but with a\n cost of accuracy\n\n<b>Cons:</b>\n Doesn't work with ACES\n\n Doesn't respect a linear workspace/ i.e the \n values in a phyically correct way" -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(1)\n\nnuke.thisNode().knob('alpha_method').setLabel('<font color=#ded990 size=\"3\">Alpha method</font>')\n\nnuke.thisNode().knob('screen_method').setLabel('Screen method')\nnuke.thisNode().knob('convolution_method').setLabel('Convolution method')\n\nnuke.thisNode().knob('blur_method').setEnabled(True)\nnuke.thisNode().knob('erode_method').setEnabled(True)\nnuke.thisNode().knob('both').setEnabled(True)\n\nnuke.thisNode().knob('both').setLabel('Both')\n"}
 addUserKnob {22 screen_method l "Screen method" t "Has a softer look than alpha method and uses a simple screen merge operation, affects the highlights a little bit which can sometimes be something useful. Screen method uses at all time the \"both\" method.\n\n<b>Pros:</b>\n Fast\n Driven by an alpha for flexibity but with a\n cost of accuracy\n\n Technically works with ACES but at the cost\n of not looking quite the same as the alpha\n method.\n\n<b>Cons:</b>\n Doesn't respect a linear workspace/ i.e the \n values in a phyically correct way." -STARTLINE T "nuke.toNode('Switch2').knob('which').setValue(0)\n\nnuke.thisNode().knob('screen_method').setLabel('<font color=#ded990 size=\"3\">Screen method</font>')\n\nnuke.thisNode().knob('alpha_method').setLabel('Alpha method')\nnuke.thisNode().knob('convolution_method').setLabel('Convolution method')\n\nnuke.thisNode().knob('blur_method').setEnabled(False)\nnuke.thisNode().knob('erode_method').setEnabled(False)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('<font color=#ded990 size=\"3\">Both</font>')\n"}
 addUserKnob {26 help_1 l "" +STARTLINE T " ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏‎  ‏‏"}
 addUserKnob {22 button_2 l Help? -STARTLINE T "nuke.message(\"Hover over the methods to find out more about them.\")"}
 addUserKnob {26 ""}
 addUserKnob {20 Key n 1}
 Key 0
 addUserKnob {26 ""}
 addUserKnob {6 alpha l "Alpha preview" t "As the name suggests if you toggle this you'll see a preview of what the alpha looks like which is where the halation will affect. It's controlled by the parameters below." +STARTLINE}
 addUserKnob {41 range l Key T Keyer1.range}
 addUserKnob {26 ""}
 addUserKnob {41 size l Blur T Blur5.size}
 addUserKnob {26 ""}
 addUserKnob {41 threshold l "Edge threshold" T EdgeDetect2.threshold}
 addUserKnob {41 size_1 l Blur T Blur1.size}
 addUserKnob {22 python_button_8 l "Reset to default" t "Reset values to a default state" T "nuke.thisNode().knob('range').setValue((0.43, 0.6, 1 ,1))\nnuke.thisNode().knob('threshold').setValue(0.6)\n\nnuke.thisNode().knob('size').setValue(25)\nnuke.thisNode().knob('size_1').setValue(5)" +STARTLINE}
 addUserKnob {41 gain l Intensity T ColorCorrect1.gain}
 addUserKnob {41 contrast l Contrast T ColorCorrect1.contrast}
 addUserKnob {22 python_button l "Reset to default" t "Reset values to a default state" T "nuke.toNode('ColorCorrect1').knob('gain').setValue(0.75)\nnuke.toNode('ColorCorrect1').knob('contrast').setValue(0.75)\n" +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {20 "" n -1}
 addUserKnob {20 Main n 1}
 Main 0
 addUserKnob {26 ""}
 addUserKnob {20 convolution l Convolution n 1}
 convolution 0
 addUserKnob {26 ""}
 addUserKnob {7 Saturation R 0 4}
 Saturation 1
 addUserKnob {22 kernel_1 l "<font color=#ded990 size=\"3\">Kernel 1</font>" T "nuke.toNode('Switch5').knob('which').setValue(0)\n\nnuke.thisNode().knob('kernel_1').setLabel('<font color=#ded990 size=\"3\">Kernel 1</font>')\n\nnuke.thisNode().knob('kernel_2').setLabel('Kernel 2')\n\nnuke.thisNode().knob('kernel_3').setLabel('Kernel 3')" +STARTLINE}
 addUserKnob {22 kernel_2 l "Kernel 2" -STARTLINE T "nuke.toNode('Switch5').knob('which').setValue(1)\n\nnuke.thisNode().knob('kernel_2').setLabel('<font color=#ded990 size=\"3\">Kernel 2</font>')\n\nnuke.thisNode().knob('kernel_1').setLabel('Kernel 1')\n\nnuke.thisNode().knob('kernel_3').setLabel('Kernel 3')"}
 addUserKnob {22 kernel_3 l "Kernel 3" -STARTLINE T "nuke.toNode('Switch5').knob('which').setValue(2)\n\nnuke.thisNode().knob('kernel_3').setLabel('<font color=#ded990 size=\"3\">Kernel 3</font>')\n\nnuke.thisNode().knob('kernel_2').setLabel('Kernel 2')\n\nnuke.thisNode().knob('kernel_1').setLabel('Kernel 1')"}
 addUserKnob {6 bleeding l "Reduce bleeding" t "If needed attemps to reduce the halation bleeding that occurs when its around the edges of the footage." +STARTLINE}
 addUserKnob {22 button l Help? T "nuke.message(\"The convolution halation is driven by the Blur controls\")\nnuke.message(\"The kernels are as of now 3 different mini methods for how the convolution renders the flare at high values.\")\nnuke.message(\"Fix artifacts is to try and fix the servere artifacts that happens when it doesn't like a certain res by scrubbing the slider until the problem seems to be gone.\")\nnuke.message(\"Reduce bleeding, if need to be. Attemps to fix the halation bleeding that occurs when its around the edges of the footage. Works better if the fix artifact is set to higher than 1.\")" +STARTLINE}
 addUserKnob {20 "" n -1}
 addUserKnob {26 ""}
 addUserKnob {20 halation l Halation n 1}
 halation 0
 addUserKnob {26 ""}
 addUserKnob {7 double l Intensity R 0 2}
 double 1
 addUserKnob {22 blur_method l "<font color=#ded990 size=\"3\">Blur method</font>" t "Uses the blur node for how the halation will spread." T "nuke.toNode('Switch1').knob('which').setValue(0)\n\nnuke.thisNode().knob('blur_method').setLabel('<font color=#ded990 size=\"3\">Blur method</font>')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('Both')" +STARTLINE}
 addUserKnob {22 erode_method l "Erode method" t "A bit harsher than blur and will instead erode the halation outwards." -STARTLINE +DISABLED T "nuke.toNode('Switch1').knob('which').setValue(1)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('<font color=#ded990 size=\"3\">Erode method</font>')\nnuke.thisNode().knob('both').setLabel('Both')"}
 addUserKnob {22 both l Both t "As the name suggests it combines both the blur method and erode method." -STARTLINE +DISABLED T "nuke.toNode('Switch1').knob('which').setValue(2)\n\nnuke.thisNode().knob('blur_method').setLabel('Blur method')\n\nnuke.thisNode().knob('erode_method').setLabel('Erode method')\nnuke.thisNode().knob('both').setLabel('<font color=#ded990 size=\"3\">Both</font>')"}
 addUserKnob {26 text_1 l <b>Blur}
 addUserKnob {18 Blur l "" +STARTLINE R 0 100}
 Blur {8 4 0}
 addUserKnob {6 Blur_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 Blur_panelDropped true
 addUserKnob {6 color_rgb_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 color_rgb_panelDropped true
 addUserKnob {6 soft l Soft +DISABLED +STARTLINE}
 soft true
 addUserKnob {6 greens l Green2Yellow t "Make any green turn to a more yellowish tone" -STARTLINE}
 addUserKnob {22 _3 l "Reset to default" t "Reset values to a default state" T "nuke.thisNode().knob('Blur').setValue((8, 4, 0))\nnuke.thisNode().knob('double').setValue(1)\n" +STARTLINE}
 addUserKnob {26 text_8 l <b>Erode</b> +DISABLED}
 addUserKnob {18 Erode l "" +STARTLINE +DISABLED R -100 0}
 Erode {-1.8 -0.9 0}
 addUserKnob {6 Erode_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 Erode_panelDropped true
 addUserKnob {22 _2 l "Reset to default" t "Reset values to a default state" +DISABLED T "nuke.thisNode().knob('Erode').setValue((-1.8, -0.9, 0))\n" +STARTLINE}
 addUserKnob {20 "" n -1}
 addUserKnob {26 ""}
 addUserKnob {20 Other t "A set of optiniol neat functions. \n\nNOTE: As of now the Flare function will only work with Alpha method enabled. The flare function is an attempt to automate a larger like halation blob on strong light sources. This is still a WIP so it's not perfect yet." n 1}
 Other 0
 addUserKnob {26 ""}
 addUserKnob {26 Glow l "" t "You can click on the color panel on the right of the knobs to change color if desired." +STARTLINE T <b>Glow</b>}
 addUserKnob {6 glow l Off/On +STARTLINE}
 addUserKnob {6 color_rgba_panelDropped l "panel dropped state" +HIDDEN +STARTLINE}
 color_rgba_panelDropped true
 addUserKnob {26 _7 l <b>Intensity +DISABLED}
 addUserKnob {18 glow_intensity l "" +STARTLINE +DISABLED R 0 10}
 glow_intensity 2.7
 addUserKnob {6 glow_intensity_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 glow_intensity_panelDropped true
 addUserKnob {26 _8 l <b>Radius +DISABLED}
 addUserKnob {18 glow_radius l "" +STARTLINE +DISABLED R 0 10000}
 glow_radius 35
 addUserKnob {6 glow_radius_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 glow_radius_panelDropped true
 addUserKnob {26 _9 l <b>Falloff +DISABLED}
 addUserKnob {18 glow_falloff l "" +STARTLINE +DISABLED R 0 10}
 glow_falloff 1
 addUserKnob {6 glow_falloff_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 addUserKnob {22 _1 l "Reset to default" t "Reset values to a default state" +DISABLED T "nuke.thisNode().knob('glow_intensity').setValue(2.7)\n\nnuke.thisNode().knob('glow_radius').setValue(35)\n\nnuke.thisNode().knob('glow_falloff').setValue(1)\n" +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {20 "" n -1}
 addUserKnob {20 "" n -1}
 addUserKnob {20 tab l F_ReGrain}
 addUserKnob {6 grain l Off/On +STARTLINE}
 addUserKnob {41 grainType l "Grain Type" T F_ReGrain1.grainType}
 addUserKnob {41 presetStock l "Preset Stock" T F_ReGrain1.presetStock}
 addUserKnob {41 amount l "Grain Amount" T F_ReGrain1.amount}
 addUserKnob {41 size_6 l "Grain Size" T F_ReGrain1.size}
 addUserKnob {41 output l Output T F_ReGrain1.output}
 addUserKnob {41 analyse l Analyse T F_ReGrain1.analyse}
 addUserKnob {20 AnalysisRegion l "Analysis Region" n 1}
 AnalysisRegion 0
 addUserKnob {41 regionBL l "Analysis Region BL" T F_ReGrain1.regionBL}
 addUserKnob {41 regionTR l "Analysis Region TR" T F_ReGrain1.regionTR}
 addUserKnob {41 frame l "Analysis Frame" T F_ReGrain1.frame}
 addUserKnob {41 grainColourSpace l "Grain Colour Space" T F_ReGrain1.grainColourSpace}
 addUserKnob {20 "" n -1}
 addUserKnob {20 Advanced n 1}
 Advanced 0
 addUserKnob {41 processRed l "Process Red" T F_ReGrain1.processRed}
 addUserKnob {41 redAmount l "Red Amount" T F_ReGrain1.redAmount}
 addUserKnob {41 redSize l "Red Size" T F_ReGrain1.redSize}
 addUserKnob {41 processGreen l "Process Green" T F_ReGrain1.processGreen}
 addUserKnob {41 greenAmount l "Green Amount" T F_ReGrain1.greenAmount}
 addUserKnob {41 greenSize l "Green Size" T F_ReGrain1.greenSize}
 addUserKnob {41 processBlue l "Process Blue" T F_ReGrain1.processBlue}
 addUserKnob {41 blueAmount l "Blue Amount" T F_ReGrain1.blueAmount}
 addUserKnob {41 blueSize l "Blue Size" T F_ReGrain1.blueSize}
 addUserKnob {20 "Grain Response" n 1}
 "Grain Response" 0
 addUserKnob {41 srcColourSpace l "Apply Grain In" T F_ReGrain1.srcColourSpace}
 addUserKnob {41 lowGain l "Low Gain" T F_ReGrain1.lowGain}
 addUserKnob {41 midGain l "Mid Gain" T F_ReGrain1.midGain}
 addUserKnob {41 highGain l "High Gain" T F_ReGrain1.highGain}
 addUserKnob {41 useResponse l "Use Sampled Response" T F_ReGrain1.useResponse}
 addUserKnob {41 responseMix l "Sampled Response Mix" T F_ReGrain1.responseMix}
 addUserKnob {41 sample l "Sample Grain Response" T F_ReGrain1.sample}
 addUserKnob {41 reset l "Reset Grain Response" T F_ReGrain1.reset}
 addUserKnob {41 drawResponse l "Draw Response" T F_ReGrain1.drawResponse}
 addUserKnob {20 "" n -1}
 addUserKnob {20 "" n -1}
 addUserKnob {41 about l About T F_ReGrain1.about}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x4aaa69ff
  label Convolution
  note_font "Verdana Bold"
  note_font_size 30
  xpos -1968
  ypos 7
  bdwidth 926
  bdheight 806
 }
 BackdropNode {
  inputs 0
  name highlight
  tile_color 0x8893b5ff
  label "OCIO Look Transform \n-\n\n\nPreserve\nHighlight"
  note_font "Verdana Bold"
  note_font_size 12
  xpos -135
  ypos -212
  bdwidth 150
  bdheight 344
 }
 BackdropNode {
  inputs 0
  name keying
  tile_color 0x545454ff
  gl_color 0xf4151bff
  label Alpha
  note_font "Verdana Bold"
  note_font_size 50
  xpos -1411
  ypos -403
  bdwidth 1126
  bdheight 354
 }
 BackdropNode {
  inputs 0
  name main
  tile_color 0x884b00ff
  label "Halation (screen method)"
  note_font "Verdana Bold"
  note_font_size 25
  xpos 170
  ypos 29
  bdwidth 331
  bdheight 287
 }
 BackdropNode {
  inputs 0
  name filter
  tile_color 0x880000ff
  label "Halation (alpha method)\n"
  note_font "Verdana Bold"
  note_font_size 25
  xpos -860
  ypos 178
  bdwidth 362
  bdheight 258
  z_order 1
 }
 Input {
  inputs 0
  name InputMask
  xpos -270
  ypos 701
  number 2
 }
set Na3bb3800 [stack 0]
 Input {
  inputs 0
  name Input
  note_font_color 0xff
  xpos -219
  ypos -352
 }
 Dot {
  name Dot39
  xpos -185
  ypos -278
 }
set Na3bb3000 [stack 0]
 Shuffle {
  alpha black
  black black
  white black
  red2 black
  green2 black
  name Shuffle7
  xpos -295
  ypos -282
 }
 Dot {
  name Dot9
  xpos -351
  ypos -278
 }
set Na3bb2800 [stack 0]
 OCIOLogConvert {
  operation "lin to log"
  name OCIOLogConvert10
  xpos -508
  ypos -281
 }
 Keyer {
  operation "luminance key"
  range {0.43 0.6 1 1}
  name Keyer1
  xpos -722
  ypos -287
 }
 Shuffle {
  red alpha
  green alpha
  blue alpha
  name Shuffle6
  xpos -863
  ypos -281
 }
 OCIOLogConvert {
  operation "log to lin"
  name OCIOLogConvert11
  xpos -1016
  ypos -281
 }
 OCIOLogConvert {
  operation "log to lin"
  name OCIOLogConvert1
  xpos -1126
  ypos -281
 }
 Defocus {
  channels rgba
  defocus 18
  name Defocus1
  xpos -1245
  ypos -281
 }
 OCIOLogConvert {
  operation "lin to log"
  name OCIOLogConvert2
  xpos -1369
  ypos -281
 }
 Blur {
  channels rgb
  size 25
  name Blur5
  xpos -1369
  ypos -202
 }
 Shuffle {
  red black
  green black
  blue black
  name Shuffle10
  xpos -1369
  ypos -95
 }
push $Na3bb2800
 Dot {
  name Dot45
  xpos -351
  ypos -240
 }
set Na3bc7c00 [stack 0]
 Dot {
  name Dot3
  xpos -351
  ypos -196
 }
 OCIOLogConvert {
  operation "lin to log"
  name OCIOLogConvert5
  xpos -492
  ypos -199
 }
 EdgeDetectWrapper {
  channels {rgba.red rgba.green -rgba.blue rgba.alpha}
  threshold 0.6
  blursize 3
  name EdgeDetect2
  xpos -635
  ypos -205
 }
 Shuffle {
  red alpha
  green alpha
  blue alpha
  name Shuffle11
  xpos -732
  ypos -199
 }
 OCIOLogConvert {
  operation "log to lin"
  name OCIOLogConvert7
  xpos -850
  ypos -199
 }
 Shuffle {
  red black
  green black
  blue black
  alpha blue
  name Shuffle12
  xpos -967
  ypos -199
 }
 ColorCorrect {
  channels alpha
  contrast 1.3
  gain 0.016
  name ColorCorrect4
  xpos -1092
  ypos -205
 }
 Blur {
  channels alpha
  size 5
  maskChannelInput -rgba.alpha
  name Blur1
  xpos -1092
  ypos -129
 }
push $Na3bc7c00
 Dot {
  name Dot47
  xpos -1164
  ypos -240
 }
 Keymix {
  inputs 3
  name Keymix1
  xpos -1198
  ypos -101
 }
 ColorCorrect {
  channels alpha
  contrast 0.75
  gamma 1.38
  gain 0.75
  name ColorCorrect1
  xpos -984
  ypos -101
 }
 Dot {
  name Dot20
  xpos -950
  ypos -19
 }
set Na3bc4c00 [stack 0]
 Dot {
  name Dot23
  label "Alpha preview"
  note_font_size 20
  xpos -950
  ypos 646
 }
 Input {
  inputs 0
  name Grain
  xpos -235
  ypos 476
  number 1
 }
push $Na3bb3800
 Constant {
  inputs 0
  channels rgb
  format "3908 2602 0 0 3908 2602 1 "
  name Constant1
  xpos -1599
  ypos 245
 }
set Na3b27c00 [stack 0]
push 0
 Group {
  inputs 0
  name Group1
  tile_color 0x2f66ff
  xpos -1489
  ypos 354
  addUserKnob {20 User}
  addUserKnob {26 Headline l "" +STARTLINE T "<font color=#80dddd size=\"7\">S</font><font color=#90dede size=\"7\">p</font><font color=#a0dfdf size=\"7\">o</font><font color=#b0e0e0 size=\"7\">t</font><font color=#c0e1e1 size=\"7\">F</font><font color=#b0e0e0 size=\"7\">l</font><font color=#a0dfdf size=\"7\">are</font><font color=#90dede size=\"3\">v</font><font color=#80dddd size=\"2\">1.0</font>"}
  addUserKnob {26 HeadlineB l "" +STARTLINE T "<font color=#80dddd size=\"2\">by Mads Hagbarth Lund</font>"}
  addUserKnob {26 devider001 l "<b><font color=#70EE70>General</font><b>"}
  addUserKnob {12 Position}
  Position {1954 1301}
  addUserKnob {7 Gain}
  Gain 0.205
  addUserKnob {7 Gamma R 0 5}
  Gamma 0.14
  addUserKnob {7 Scale}
  Scale 0.315
  addUserKnob {6 SoftClip t "By default, spotflare will be very bright at the center. Use softclip to limit the maximum brightness." +STARTLINE}
  addUserKnob {7 softclipmax l max -STARTLINE R 1 100}
  softclipmax 100
  addUserKnob {6 glow_enable l Glow +STARTLINE}
  glow_enable true
  addUserKnob {6 EffectOnly l "Effect Only" +STARTLINE}
  EffectOnly true
  addUserKnob {22 FixJitter l "Fix Jitter" t "This does nothing... yet still fixes the bug with the expression node not updating its cashe from time to time.\nPlease fix The Foundry!" +STARTLINE}
  addUserKnob {26 devider02 l "<b><font color=#70EE70>Color</font><b>"}
  addUserKnob {18 GainTint}
  GainTint {0.647098 0.305 0.135}
  addUserKnob {6 GainTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  GainTint_panelDropped true
  addUserKnob {18 GammaTint}
  GammaTint {1 0.84 0.17}
  addUserKnob {6 GammaTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  GammaTint_panelDropped true
  addUserKnob {26 devide01 l "" +STARTLINE T " "}
  addUserKnob {22 Reset l "Reset Color" T "nuke.thisNode().knob(\"GainTint\").setValue(1,0)\nnuke.thisNode().knob(\"GainTint\").setValue(1,1)\nnuke.thisNode().knob(\"GainTint\").setValue(1,2)\nnuke.thisNode().knob(\"GainTint\").setValue(1,3)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,0)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,1)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,2)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,3)" +STARTLINE}
  addUserKnob {26 DeviderShimmer l "<b><font color=#70EE70>Shimmer</font><b>"}
  addUserKnob {6 shimmer_enable l Shimmer +STARTLINE}
  shimmer_enable true
  addUserKnob {7 lacunarity l Detail R 0 5}
  lacunarity 5
  addUserKnob {7 noise_gain l Gain}
  noise_gain 1
  addUserKnob {7 Speed}
  Speed 0.635
  addUserKnob {7 Noise_Gang l "Time Offset" R 0 1000}
  Noise_Gang 240
  addUserKnob {26 devider04 l "<b><font color=#70EE70>Masking</font><b>"}
  addUserKnob {6 Mask +STARTLINE}
  addUserKnob {7 MaskRotation l "Mask Rotation"}
  MaskRotation 0.31
  addUserKnob {7 MaskGain l "Mask Gain"}
  MaskGain 0.4
  addUserKnob {7 MaskSoftness R 0 10}
  MaskSoftness 2.35
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x7171c600
   label Spike
   note_font_size 42
   xpos -222
   ypos 207
   bdwidth 270
   bdheight 257
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Glow
   note_font_size 42
   xpos -597
   ypos 209
   bdwidth 280
   bdheight 258
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x8e388e00
   label Glare
   note_font_size 42
   xpos -1156
   ypos 207
   bdwidth 468
   bdheight 298
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0xffffffff
   gl_color 0xff
   label "WELCOME TO SPOTFLARE"
   note_font_size 42
   xpos -904
   ypos -206
   bdwidth 523
   bdheight 138
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   tile_color 0x71c67100
   label "Spot Facing"
   note_font_size 42
   xpos -1463
   ypos 208
   bdwidth 252
   bdheight 258
  }
  BackdropNode {
   inputs 0
   name BackdropNode6
   tile_color 0xff
   label "PLEASE ENJOY"
   note_font_size 42
   xpos -801
   ypos 896
   bdwidth 333
   bdheight 160
  }
  StickyNote {
   inputs 0
   name StickyNote2
   label "This is a super inefficient way\nto avoid the 1-0 seam and\na major performence hit.\nIf anyone have a better solution,\nplease mail me! =)"
   note_font_size 8
   xpos -1045
   ypos 350
  }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0xcc0000ff
   gl_color 0xcc0000ff
   label "not yet implamented"
   xpos -222
   ypos 206
  }
  Dot {
   inputs 0
   name Dot19
   tile_color 0xff0000ff
   xpos -674
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot20
   tile_color 0xffff00ff
   xpos -658
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot21
   tile_color 0xff00ff
   xpos -641
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot22
   tile_color 0xffffff
   xpos -624
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot23
   tile_color 0xffff
   xpos -607
   ypos -127
   hide_input true
  }
  Input {
   inputs 0
   name Input1
   xpos -674
   ypos -106
  }
  Dot {
   name Dot13
   xpos -640
   ypos -25
  }
set Na3ee7c00 [stack 0]
  Reformat {
   format "3908 2602 0 0 3908 2602 1 "
   black_outside true
   name Reformat1
   selected true
   xpos -674
   ypos 11
  }
  Shuffle {
   red black
   green black
   blue black
   alpha black
   name Shuffle3
   xpos -674
   ypos 35
  }
  Dot {
   name Dot1
   xpos -640
   ypos 131
  }
set Na3ee6c00 [stack 0]
  Dot {
   name Dot9
   xpos -456
   ypos 131
  }
set Na3ee6800 [stack 0]
  Dot {
   name Dot2
   xpos -61
   ypos 131
  }
  Expression {
   expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ (pi))/(pi*2)"
   name Expression8
   xpos -95
   ypos 268
  }
  Expression {
   expr0 sin(r*(16*pi))
   name Expression14
   xpos -95
   ypos 310
  }
  Grade {
   white 0.89
   gamma 0.2
   name Grade6
   xpos -95
   ypos 352
  }
  Shuffle {
   green red
   blue red
   alpha red
   name Shuffle2
   xpos -95
   ypos 396
  }
push $Na3ee6800
  Expression {
   temp_name0 xd
   temp_expr0 parent.Position.x-x
   temp_name1 yd
   temp_expr1 parent.Position.y-y
   temp_name2 dist
   temp_expr2 "sqrt(xd*xd + yd*yd)"
   temp_name3 scale
   temp_expr3 "dist / ((parent.Scale*1))"
   expr0 scale
   channel1 {-rgba.red -rgba.green -rgba.blue none}
   channel2 {-rgba.red -rgba.green -rgba.blue none}
   channel3 {none none none -rgba.alpha}
   enable_mix_luminance false
   name distance
   xpos -490
   ypos 262
  }
  Grade {
   white {{pow(1-parent.Gain,4)}}
   gamma {{pow2(parent.Gamma)}}
   name Grade16
   xpos -490
   ypos 305
  }
  Expression {
   temp_name3 invsqr
   temp_expr3 isnan(r)?0:1/(r*r)
   expr0 invsqr
   expr1 invsqr
   expr2 invsqr
   name Inverse_Square
   xpos -490
   ypos 341
  }
  Grade {
   white {{parent.GainTint.r} {parent.GainTint.g} {parent.GainTint.b} 1}
   white_panelDropped true
   multiply {1 1 1 1}
   multiply_panelDropped true
   gamma {{parent.GammaTint} {parent.GammaTint} {parent.GammaTint} 1}
   name Grade2
   xpos -490
   ypos 387
  }
  Clamp {
   maximum 59999
   MinClampTo_enable true
   MaxClampTo {{maximum}}
   MaxClampTo_enable true
   name Clamp_Superbrights
   xpos -490
   ypos 428
  }
set Na3e7fc00 [stack 0]
  Merge2 {
   inputs 2
   operation multiply
   name Merge3
   xpos -95
   ypos 434
  }
  Dot {
   name Dot3
   xpos -61
   ypos 708
  }
  Dot {
   name Dot15
   xpos -572
   ypos 708
  }
push $Na3ee6c00
  Dot {
   name Dot16
   xpos -750
   ypos 131
  }
set Na3e7ec00 [stack 0]
  Dot {
   name Dot17
   xpos -868
   ypos 131
  }
  Dot {
   name Dot7
   xpos -1332
   ypos 131
  }
  Expression {
   temp_name0 theta
   temp_expr0 pi*(parent.MaskRotation*2)
   temp_name1 px
   temp_expr1 "cos(theta) * (x-parent.Position.x) - sin(theta) * (y-parent.Position.y) + parent.Position.x"
   temp_name2 py
   temp_expr2 "sin(theta) * (x-parent.Position.x) + cos(theta) * (y-parent.Position.y) + parent.Position.y"
   temp_name3 val
   temp_expr3 "(atan(px-parent.Position.x,-py--parent.Position.y)+ pi)/+ (pi*2)"
   expr0 "smoothstep(0,1, sin(val*pi))"
   name Expression1
   xpos -1366
   ypos 298
  }
  Grade {
   black 0.033
   white {{(pow(parent.MaskGain,2)*10)+0.0001}}
   gamma {{(pow(parent.MaskSoftness,2)/2)+0.15}}
   name Grade9
   xpos -1366
   ypos 336
  }
  Expression {
   expr0 max(0,1-r)
   expr1 max(0,1-r)
   expr2 max(0,1-r)
   name Expression17
   xpos -1366
   ypos 380
  }
  Dot {
   name Dot8
   xpos -1332
   ypos 745
  }
push $Na3e7ec00
  Dot {
   name Dot4
   xpos -750
   ypos 230
  }
set Na3e7d000 [stack 0]
  Dot {
   name Dot5
   xpos -868
   ypos 230
  }
  Expression {
   expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ pi)/+ (pi*2)"
   name inversefacing
   xpos -902
   ypos 267
  }
set Na3e7c800 [stack 0]
  Dot {
   name Dot18
   xpos -978
   ypos 270
  }
  Expression {
   expr0 pow(sin(r*pi),16)
   name reduction
   xpos -1012
   ypos 313
  }
set Na3e27c00 [stack 0]
  Dot {
   name Dot10
   xpos -978
   ypos 415
  }
push $Na3e27c00
push $Na3e7c800
  ShuffleCopy {
   inputs 2
   green red
   alpha alpha2
   name ShuffleCopy1
   xpos -902
   ypos 313
  }
  Expression {
   temp_name0 octaves
   temp_expr0 5
   temp_name1 lacunarity
   temp_expr1 parent.lacunarity
   temp_name2 gain
   temp_expr2 parent.noise_gain
   temp_name3 Noise
   temp_expr3 g>0.0001?fBm(r,1,1+((frame+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain):0
   expr0 Noise
   expr1 Noise
   expr2 Noise
   name noise_top
   xpos -902
   ypos 348
  }
  Grade {
   black 0.54
   gamma 0.585
   black_clamp false
   name Grade14
   xpos -902
   ypos 388
  }
push $Na3e7d000
  Expression {
   temp_name0 xd
   temp_expr0 parent.Position.x-x
   temp_name1 yd
   temp_expr1 parent.Position.y-y
   temp_name2 dist
   temp_expr2 "sqrt(xd*xd + yd*yd)"
   expr0 "(atan(x-parent.Position.x,y-parent.Position.y)+ pi)/+ (pi*2)"
   expr1 dist/width
   name facing
   xpos -784
   ypos 267
  }
  Expression {
   temp_name0 octaves
   temp_expr0 5
   temp_name1 lacunarity
   temp_expr1 parent.lacunarity
   temp_name2 gain
   temp_expr2 parent.noise_gain
   temp_name3 Noise
   temp_expr3 fBm(r,1,1+((frame+8+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain)
   expr0 Noise
   expr1 Noise
   expr2 Noise
   name noise
   xpos -784
   ypos 314
  }
  Grade {
   black 0.54
   gamma 0.585
   black_clamp false
   name Grade15
   xpos -784
   ypos 412
  }
  Merge2 {
   inputs 2+1
   operation copy
   maskChannelMask rgba.red
   name FixSeam
   xpos -902
   ypos 412
  }
push $Na3e7fc00
  Merge2 {
   inputs 2
   operation multiply
   name Merge1
   xpos -902
   ypos 436
  }
  Clamp {
   maximum_enable false
   name Clamp_Negative_Numbers
   xpos -902
   ypos 460
  }
  Dot {
   name Dot6
   xpos -868
   ypos 660
  }
push $Na3e7fc00
  Dot {
   name Dot11
   xpos -456
   ypos 587
  }
push $Na3ee6c00
  Merge2 {
   inputs 2
   operation plus
   name Merge6
   xpos -674
   ypos 584
   disable {{1-parent.glow_enable}}
  }
  Merge2 {
   inputs 2
   operation plus
   name Merge2
   xpos -674
   ypos 657
   disable {{1-parent.shimmer_enable x2012 1}}
  }
  Merge2 {
   inputs 2
   operation multiply
   name Merge5
   xpos -674
   ypos 742
   disable {{1-parent.Mask}}
  }
  SoftClip {
   conversion "preserve hue and saturation"
   softclip_min 1
   softclip_max {{parent.softclipmax}}
   name SoftClip1
   xpos -674
   ypos 766
   disable {{1-parent.SoftClip}}
  }
push $Na3ee7c00
  Dot {
   name Dot12
   xpos -689
   ypos -25
  }
  Grade {
   multiply 0
   black_clamp false
   enable_mix_luminance false
   name Grade1
   xpos -723
   ypos 77
   disable {{1-parent.EffectOnly}}
  }
  Dot {
   name Dot14
   xpos -692
   ypos 794
  }
  Merge2 {
   inputs 2
   operation plus
   name Merge7
   xpos -674
   ypos 791
  }
  Output {
   name Output1
   xpos -674
   ypos 991
  }
 end_group
push $Na3b27c00
 Merge2 {
  inputs 3+1
  name Merge7
  xpos -1599
  ypos 354
 }
 Dot {
  name Dot53
  xpos -1565
  ypos 398
 }
set Na3da5c00 [stack 0]
 Dot {
  name Dot55
  xpos -1821
  ypos 398
 }
 Grade {
  channels {rgba.red -rgba.green -rgba.blue none}
  gamma 1.15
  name Grade3
  xpos -1855
  ypos 513
 }
 Transform {
  scale 0.11
  center {1954 1301}
  name Transform3
  xpos -1764
  ypos 513
 }
 Group {
  name apGlow5
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1764
  ypos 576
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 1
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na3d53800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na3d53400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na3d53400
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
add_layer {apGlowArea apGlowArea.red}
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na3d51000 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na3d50800 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na3d51000
push $Na3d50800
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na3d53800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na3cf9c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na3cf9c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow6
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1855
  ypos 576
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 0.3
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na3c8a400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na3c8a000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na3c8a000
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na3c37800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na3c37000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na3c37800
push $Na3c37000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na3c8a400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na3c34800 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na3c34800
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow13
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1855
  ypos 636
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 0.16
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r*1.5}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 9.7
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na3fd5000 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na3fd4c00 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na3fd4c00
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na3f8a400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na3f89c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na3f8a400
push $Na3f89c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na3fd5000
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na3f2b000 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na3f2b000
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Grade {
  channels {rgba.red -rgba.green -rgba.blue none}
  gamma 1.56
  name Grade7
  xpos -1761
  ypos 642
 }
 Dot {
  name Dot58
  xpos -1727
  ypos 705
 }
 Dot {
  name Dot63
  xpos -1916
  ypos 705
 }
 Dot {
  name Dot64
  xpos -1916
  ypos 173
 }
push $Na3da5c00
 Dot {
  name Dot54
  xpos -1357
  ypos 398
 }
 Grade {
  channels {rgba.red -rgba.green -rgba.blue none}
  gamma 1.05
  name Grade6
  xpos -1391
  ypos 492
 }
 Transform {
  scale 0.79
  center {1954 1301}
  name Transform5
  xpos -1290
  ypos 492
 }
 Grade {
  channels {rgba.red rgba.green rgba.blue none}
  whitepoint 1.08
  gamma 0.62
  name Grade5
  xpos -1290
  ypos 541
 }
 Transform {
  scale 0.88
  skewX 0.01
  center {1954 1301}
  name Transform6
  xpos -1389
  ypos 541
 }
 Group {
  name apGlow9
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1389
  ypos 584
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 1
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 10
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 4
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na42c5400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na42c5000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na42c5000
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4266800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4266000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4266800
push $Na4266000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na42c5400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na41f7400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na41f7400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow10
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1286
  ypos 584
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 0.19
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 10
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 4
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 4.9
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na41abc00 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na41ab800 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na41ab800
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na41a9400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na41a8c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na41a9400
push $Na41a8c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na41abc00
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na414e000 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na414e000
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow11
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1286
  ypos 645
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 0.27
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 5.8
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g*1.1}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 5.2
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na40e6800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na40e6400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na40e6400
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na409bc00 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na409b400 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na409bc00
push $Na409b400
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na40e6800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4098c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4098c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow12
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1389
  ypos 645
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r*1.5}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 3.45
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4039400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4039000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4039000
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na43d6800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na43d6000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na43d6800
push $Na43d6000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4039400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4377400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4377400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Dot {
  name Dot56
  xpos -1355
  ypos 713
 }
 Group {
  name apGlow7
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1312
  ypos 704
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 1
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 10
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 4
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.b}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 2
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na432b800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na432b400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na432b400
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4329000 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4328800 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4329000
push $Na4328800
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na432b800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na46c9c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na46c9c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Dot {
  name Dot52
  xpos -1162
  ypos 713
 }
 Group {
  name apGlow8
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1196
  ypos 646
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 5.9
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 5.8
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.b*1.1}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 7.4
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4672000 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4671c00 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4671c00
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4617400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4616c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4617400
push $Na4616c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4672000
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4614400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4614400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Dot {
  name Dot59
  xpos -1162
  ypos 275
 }
 Dot {
  name Dot60
  xpos -1371
  ypos 275
 }
 Group {
  inputs 0
  name Group3
  tile_color 0x2f66ff
  xpos -1517
  ypos 522
  addUserKnob {20 User}
  addUserKnob {26 Headline l "" +STARTLINE T "<font color=#80dddd size=\"7\">S</font><font color=#90dede size=\"7\">p</font><font color=#a0dfdf size=\"7\">o</font><font color=#b0e0e0 size=\"7\">t</font><font color=#c0e1e1 size=\"7\">F</font><font color=#b0e0e0 size=\"7\">l</font><font color=#a0dfdf size=\"7\">are</font><font color=#90dede size=\"3\">v</font><font color=#80dddd size=\"2\">1.0</font>"}
  addUserKnob {26 HeadlineB l "" +STARTLINE T "<font color=#80dddd size=\"2\">by Mads Hagbarth Lund</font>"}
  addUserKnob {26 devider001 l "<b><font color=#70EE70>General</font><b>"}
  addUserKnob {12 Position}
  Position {1954 1301}
  addUserKnob {7 Gain}
  addUserKnob {7 Gamma R 0 5}
  Gamma 0.9
  addUserKnob {7 Scale}
  Scale 0.01
  addUserKnob {6 SoftClip t "By default, spotflare will be very bright at the center. Use softclip to limit the maximum brightness." +STARTLINE}
  addUserKnob {7 softclipmax l max -STARTLINE R 1 100}
  softclipmax 100
  addUserKnob {6 glow_enable l Glow +STARTLINE}
  glow_enable true
  addUserKnob {6 EffectOnly l "Effect Only" +STARTLINE}
  EffectOnly true
  addUserKnob {22 FixJitter l "Fix Jitter" t "This does nothing... yet still fixes the bug with the expression node not updating its cashe from time to time.\nPlease fix The Foundry!" +STARTLINE}
  addUserKnob {26 devider02 l "<b><font color=#70EE70>Color</font><b>"}
  addUserKnob {18 GainTint}
  GainTint {1 0.375 0}
  addUserKnob {6 GainTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  GainTint_panelDropped true
  addUserKnob {18 GammaTint}
  GammaTint {1 0.85 0}
  addUserKnob {6 GammaTint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  GammaTint_panelDropped true
  addUserKnob {26 devide01 l "" +STARTLINE T " "}
  addUserKnob {22 Reset l "Reset Color" T "nuke.thisNode().knob(\"GainTint\").setValue(1,0)\nnuke.thisNode().knob(\"GainTint\").setValue(1,1)\nnuke.thisNode().knob(\"GainTint\").setValue(1,2)\nnuke.thisNode().knob(\"GainTint\").setValue(1,3)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,0)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,1)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,2)\nnuke.thisNode().knob(\"GammaTint\").setValue(1,3)" +STARTLINE}
  addUserKnob {26 DeviderShimmer l "<b><font color=#70EE70>Shimmer</font><b>"}
  addUserKnob {6 shimmer_enable l Shimmer +STARTLINE}
  shimmer_enable true
  addUserKnob {7 lacunarity l Detail R 0 5}
  lacunarity 4.5
  addUserKnob {7 noise_gain l Gain}
  noise_gain 7
  addUserKnob {7 Speed}
  Speed 0.635
  addUserKnob {7 Noise_Gang l "Time Offset" R 0 1000}
  Noise_Gang 240
  addUserKnob {26 devider04 l "<b><font color=#70EE70>Masking</font><b>"}
  addUserKnob {6 Mask +STARTLINE}
  addUserKnob {7 MaskRotation l "Mask Rotation"}
  MaskRotation 0.31
  addUserKnob {7 MaskGain l "Mask Gain"}
  MaskGain 0.4
  addUserKnob {7 MaskSoftness R 0 10}
  MaskSoftness 2.35
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x7171c600
   label Spike
   note_font_size 42
   xpos -222
   ypos 207
   bdwidth 270
   bdheight 257
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Glow
   note_font_size 42
   xpos -597
   ypos 209
   bdwidth 280
   bdheight 258
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x8e388e00
   label Glare
   note_font_size 42
   xpos -1156
   ypos 207
   bdwidth 468
   bdheight 298
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0xffffffff
   gl_color 0xff
   label "WELCOME TO SPOTFLARE"
   note_font_size 42
   xpos -904
   ypos -206
   bdwidth 523
   bdheight 138
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   tile_color 0x71c67100
   label "Spot Facing"
   note_font_size 42
   xpos -1463
   ypos 208
   bdwidth 252
   bdheight 258
  }
  BackdropNode {
   inputs 0
   name BackdropNode6
   tile_color 0xff
   label "PLEASE ENJOY"
   note_font_size 42
   xpos -801
   ypos 896
   bdwidth 333
   bdheight 160
  }
  StickyNote {
   inputs 0
   name StickyNote2
   label "This is a super inefficient way\nto avoid the 1-0 seam and\na major performence hit.\nIf anyone have a better solution,\nplease mail me! =)"
   note_font_size 8
   xpos -1045
   ypos 350
  }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0xcc0000ff
   gl_color 0xcc0000ff
   label "not yet implamented"
   xpos -222
   ypos 206
  }
  Dot {
   inputs 0
   name Dot19
   tile_color 0xff0000ff
   xpos -674
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot20
   tile_color 0xffff00ff
   xpos -658
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot21
   tile_color 0xff00ff
   xpos -641
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot22
   tile_color 0xffffff
   xpos -624
   ypos -127
   hide_input true
  }
  Dot {
   inputs 0
   name Dot23
   tile_color 0xffff
   xpos -607
   ypos -127
   hide_input true
  }
  Input {
   inputs 0
   name Input1
   xpos -674
   ypos -106
  }
  Dot {
   name Dot13
   xpos -640
   ypos -25
  }
set Na4561800 [stack 0]
  Reformat {
   format "3908 2602 0 0 3908 2602 1 "
   black_outside true
   name Reformat1
   selected true
   xpos -674
   ypos 11
  }
  Shuffle {
   red black
   green black
   blue black
   alpha black
   name Shuffle3
   xpos -674
   ypos 35
  }
  Dot {
   name Dot1
   xpos -640
   ypos 131
  }
set Na4560800 [stack 0]
  Dot {
   name Dot9
   xpos -456
   ypos 131
  }
set Na4560400 [stack 0]
  Dot {
   name Dot2
   xpos -61
   ypos 131
  }
  Expression {
   expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ (pi))/(pi*2)"
   name Expression8
   xpos -95
   ypos 268
  }
  Expression {
   expr0 sin(r*(16*pi))
   name Expression14
   xpos -95
   ypos 310
  }
  Grade {
   white 0.89
   gamma 0.2
   name Grade6
   xpos -95
   ypos 352
  }
  Shuffle {
   green red
   blue red
   alpha red
   name Shuffle2
   xpos -95
   ypos 396
  }
push $Na4560400
  Expression {
   temp_name0 xd
   temp_expr0 parent.Position.x-x
   temp_name1 yd
   temp_expr1 parent.Position.y-y
   temp_name2 dist
   temp_expr2 "sqrt(xd*xd + yd*yd)"
   temp_name3 scale
   temp_expr3 "dist / ((parent.Scale*1))"
   expr0 scale
   channel1 {-rgba.red -rgba.green -rgba.blue none}
   channel2 {-rgba.red -rgba.green -rgba.blue none}
   channel3 {none none none -rgba.alpha}
   enable_mix_luminance false
   name distance
   xpos -490
   ypos 262
  }
  Grade {
   white {{pow(1-parent.Gain,4)}}
   gamma {{pow2(parent.Gamma)}}
   name Grade16
   xpos -490
   ypos 305
  }
  Expression {
   temp_name3 invsqr
   temp_expr3 isnan(r)?0:1/(r*r)
   expr0 invsqr
   expr1 invsqr
   expr2 invsqr
   name Inverse_Square
   xpos -490
   ypos 341
  }
  Grade {
   white {{parent.GainTint.r} {parent.GainTint.g} {parent.GainTint.b} 1}
   white_panelDropped true
   multiply {1 1 1 1}
   multiply_panelDropped true
   gamma {{parent.GammaTint} {parent.GammaTint} {parent.GammaTint} 1}
   name Grade2
   xpos -490
   ypos 387
  }
  Clamp {
   maximum 59999
   MinClampTo_enable true
   MaxClampTo {{maximum}}
   MaxClampTo_enable true
   name Clamp_Superbrights
   xpos -490
   ypos 428
  }
set Na4531800 [stack 0]
  Merge2 {
   inputs 2
   operation multiply
   name Merge3
   xpos -95
   ypos 434
  }
  Dot {
   name Dot3
   xpos -61
   ypos 708
  }
  Dot {
   name Dot15
   xpos -572
   ypos 708
  }
push $Na4560800
  Dot {
   name Dot16
   xpos -750
   ypos 131
  }
set Na4530800 [stack 0]
  Dot {
   name Dot17
   xpos -868
   ypos 131
  }
  Dot {
   name Dot7
   xpos -1332
   ypos 131
  }
  Expression {
   temp_name0 theta
   temp_expr0 pi*(parent.MaskRotation*2)
   temp_name1 px
   temp_expr1 "cos(theta) * (x-parent.Position.x) - sin(theta) * (y-parent.Position.y) + parent.Position.x"
   temp_name2 py
   temp_expr2 "sin(theta) * (x-parent.Position.x) + cos(theta) * (y-parent.Position.y) + parent.Position.y"
   temp_name3 val
   temp_expr3 "(atan(px-parent.Position.x,-py--parent.Position.y)+ pi)/+ (pi*2)"
   expr0 "smoothstep(0,1, sin(val*pi))"
   name Expression1
   xpos -1366
   ypos 298
  }
  Grade {
   black 0.033
   white {{(pow(parent.MaskGain,2)*10)+0.0001}}
   gamma {{(pow(parent.MaskSoftness,2)/2)+0.15}}
   name Grade9
   xpos -1366
   ypos 336
  }
  Expression {
   expr0 max(0,1-r)
   expr1 max(0,1-r)
   expr2 max(0,1-r)
   name Expression17
   xpos -1366
   ypos 380
  }
  Dot {
   name Dot8
   xpos -1332
   ypos 745
  }
push $Na4530800
  Dot {
   name Dot4
   xpos -750
   ypos 230
  }
set Na44ba800 [stack 0]
  Dot {
   name Dot5
   xpos -868
   ypos 230
  }
  Expression {
   expr0 "(atan(x-parent.Position.x,-y--parent.Position.y)+ pi)/+ (pi*2)"
   name inversefacing
   xpos -902
   ypos 267
  }
set Na44ba000 [stack 0]
  Dot {
   name Dot18
   xpos -978
   ypos 270
  }
  Expression {
   expr0 pow(sin(r*pi),16)
   name reduction
   xpos -1012
   ypos 313
  }
set Na44b9800 [stack 0]
  Dot {
   name Dot10
   xpos -978
   ypos 415
  }
push $Na44b9800
push $Na44ba000
  ShuffleCopy {
   inputs 2
   green red
   alpha alpha2
   name ShuffleCopy1
   xpos -902
   ypos 313
  }
  Expression {
   temp_name0 octaves
   temp_expr0 5
   temp_name1 lacunarity
   temp_expr1 parent.lacunarity
   temp_name2 gain
   temp_expr2 parent.noise_gain
   temp_name3 Noise
   temp_expr3 g>0.0001?fBm(r,1,1+((frame+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain):0
   expr0 Noise
   expr1 Noise
   expr2 Noise
   name noise_top
   xpos -902
   ypos 348
  }
  Grade {
   black 0.54
   gamma 0.585
   black_clamp false
   name Grade14
   xpos -902
   ypos 388
  }
push $Na44ba800
  Expression {
   temp_name0 xd
   temp_expr0 parent.Position.x-x
   temp_name1 yd
   temp_expr1 parent.Position.y-y
   temp_name2 dist
   temp_expr2 "sqrt(xd*xd + yd*yd)"
   expr0 "(atan(x-parent.Position.x,y-parent.Position.y)+ pi)/+ (pi*2)"
   expr1 dist/width
   name facing
   xpos -784
   ypos 267
  }
  Expression {
   temp_name0 octaves
   temp_expr0 5
   temp_name1 lacunarity
   temp_expr1 parent.lacunarity
   temp_name2 gain
   temp_expr2 parent.noise_gain
   temp_name3 Noise
   temp_expr3 fBm(r,1,1+((frame+8+parent.Noise_Gang)/((1.0001-parent.Speed)*10000)),octaves,lacunarity,gain)
   expr0 Noise
   expr1 Noise
   expr2 Noise
   name noise
   xpos -784
   ypos 314
  }
  Grade {
   black 0.54
   gamma 0.585
   black_clamp false
   name Grade15
   xpos -784
   ypos 412
  }
  Merge2 {
   inputs 2+1
   operation copy
   maskChannelMask rgba.red
   name FixSeam
   xpos -902
   ypos 412
  }
push $Na4531800
  Merge2 {
   inputs 2
   operation multiply
   name Merge1
   xpos -902
   ypos 436
  }
  Clamp {
   maximum_enable false
   name Clamp_Negative_Numbers
   xpos -902
   ypos 460
  }
  Dot {
   name Dot6
   xpos -868
   ypos 660
  }
push $Na4531800
  Dot {
   name Dot11
   xpos -456
   ypos 587
  }
push $Na4560800
  Merge2 {
   inputs 2
   operation plus
   name Merge6
   xpos -674
   ypos 584
   disable {{1-parent.glow_enable}}
  }
  Merge2 {
   inputs 2
   operation plus
   name Merge2
   xpos -674
   ypos 657
   disable {{1-parent.shimmer_enable x2012 1}}
  }
  Merge2 {
   inputs 2
   operation multiply
   name Merge5
   xpos -674
   ypos 742
   disable {{1-parent.Mask}}
  }
  SoftClip {
   conversion "preserve hue and saturation"
   softclip_min 1
   softclip_max {{parent.softclipmax}}
   name SoftClip1
   xpos -674
   ypos 766
   disable {{1-parent.SoftClip}}
  }
push $Na4561800
  Dot {
   name Dot12
   xpos -689
   ypos -25
  }
  Grade {
   multiply 0
   black_clamp false
   enable_mix_luminance false
   name Grade1
   xpos -723
   ypos 77
   disable {{1-parent.EffectOnly}}
  }
  Dot {
   name Dot14
   xpos -692
   ypos 794
  }
  Merge2 {
   inputs 2
   operation plus
   name Merge7
   xpos -674
   ypos 791
  }
  Output {
   name Output1
   xpos -674
   ypos 991
  }
 end_group
 Constant {
  inputs 0
  channels rgb
  format "3908 2602 0 0 3908 2602 1 "
  name Constant3
  xpos -1627
  ypos 433
 }
 Merge2 {
  inputs 2
  name Merge8
  xpos -1627
  ypos 522
 }
 Clamp {
  name Clamp4
  xpos -1627
  ypos 557
 }
 ColorCorrect {
  gamma 0.79
  shadows.gain 1.32
  midtones.gamma 5
  midtones.gain 0
  name ColorCorrect11
  xpos -1627
  ypos 593
 }
 Transform {
  scale 0.58
  center {1954 1301}
  name Transform4
  xpos -1627
  ypos 617
 }
 Group {
  name apGlow15
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1493
  ypos 611
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na47e1400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na47e1000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na47e1000
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4766800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4766000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4766800
push $Na4766000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na47e1400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4707400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4707400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow17
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1493
  ypos 659
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4ab3c00 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4ab3800 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4ab3800
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4ab1400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4ab0c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4ab1400
push $Na4ab0c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4ab3c00
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4a5a000 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4a5a000
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow16
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1624
  ypos 659
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na49ee800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na49ee400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na49ee400
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na49a3c00 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na49a3400 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na49a3c00
push $Na49a3400
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na49ee800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na49a0c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na49a0c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow18
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1624
  ypos 706
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4935400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4935000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4935000
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na48ea800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na48ea000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na48ea800
push $Na48ea000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4935400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4883400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4883400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow19
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1492
  ypos 706
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.b}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4827c00 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4827800 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4827800
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4825400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4824c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4825400
push $Na4824c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4827c00
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4bd2000 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4bd2000
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow20
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -1492
  ypos 771
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity 10
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 0.54
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.b}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 1
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  addUserKnob {14 overscan R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na4b72800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na4b72400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na4b72400
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na4b1bc00 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na4b1b400 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na4b1bc00
push $Na4b1b400
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na4b72800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na4b18c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na4b18c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Dot {
  name Dot62
  xpos -1409
  ypos 780
 }
 Dot {
  name Dot57
  xpos -1409
  ypos 199
 }
 Switch {
  inputs 3
  name Switch5
  xpos -1405
  ypos 170
 }
set Na4eadc00 [stack 0]
push $Na3bb3000
 Shuffle {
  alpha black
  black black
  white black
  red2 black
  green2 black
  name Shuffle4
  xpos -219
  ypos -242
 }
 Reformat {
  type "to box"
  box_width 2048
  box_height 1556
  resize none
  center false
  name Reformat1
  xpos -219
  ypos -194
  addUserKnob {20 User}
  addUserKnob {7 sumBox}
  sumBox {{input.height+input.width}}
  addUserKnob {7 inputWidth}
  inputWidth {{input.width}}
  addUserKnob {7 inputHeight}
  inputHeight {{input.height}}
 }
 Dot {
  name Dot38
  xpos -185
  ypos -45
 }
 Dot {
  name Dot37
  xpos -1101
  ypos -45
 }
 Transform {
  scale 0.98
  center {960 540}
  name Transform1
  xpos -1135
  ypos 82
  disable {{parent.bleeding==0}}
 }
set Na4eac400 [stack 0]
 Group {
  inputs 3
  name LensKernelFFT1
  tile_color 0xff7f28ff
  xpos -1405
  ypos 76
  addUserKnob {20 User}
  addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
  addUserKnob {4 c l channels M {RGB RGBA ""}}
  addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
  addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
  addUserKnob {7 mix}
  mix 1
  addUserKnob {20 Kernels}
  addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
  addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
  addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
 }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read3
   xpos -184
   ypos -88
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read2
   xpos -387
   ypos -128
  }
  Input {
   inputs 0
   name Input2
   xpos -672
   ypos 46
   number 1
  }
  Switch {
   inputs 3
   which {{parent.kernel}}
   name Switch1
   xpos -382
   ypos 91
  }
  Transform {
   translate {1 0}
   center {1954 1301}
   name Transform
   label recenter
   xpos -382
   ypos 122
   disable true
  }
  Dot {
   name Dot1
   xpos -348
   ypos 170
  }
set Na4e66000 [stack 0]
  Dot {
   name Dot2
   xpos -238
   ypos 170
  }
  Saturation {
   saturation 0
   name Saturation
   label luminance
   xpos -272
   ypos 224
  }
push $Na4e66000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.alpha
   name Copy
   label luminance->alpha
   xpos -382
   ypos 218
  }
  Dot {
   name Dot10
   xpos -348
   ypos 272
  }
set Na4e65000 [stack 0]
  Dot {
   name Dot9
   xpos -458
   ypos 272
  }
  Dot {
   name Dot11
   xpos -458
   ypos 745
  }
  Input {
   inputs 0
   name Input1
   xpos 0
   ypos -11
  }
  NoOp {
   name ImgIn
   xpos 0
   ypos 13
  }
  Dot {
   name Dot12
   xpos 34
   ypos 59
  }
set Na4e23800 [stack 0]
  Reformat {
   type "to box"
   box_width {{"width + (2* parent.pad)"}}
   box_height {{"height + (2* parent.pad)"}}
   resize none
   name Reformat_PadFrame
   xpos 0
   ypos 349
  }
  FFT {
   channels rgba
   name FFT2
   xpos 0
   ypos 395
  }
  Dot {
   name Dot3
   xpos 34
   ypos 451
  }
push $Na4e65000
  Reformat {
   type "to box"
   box_width {{LensKernelFFT1.Reformat_PadFrame.box_width.main}}
   box_height {{LensKernelFFT1.Reformat_PadFrame.box_height.main}}
   resize none
   name ReformatKernel
   xpos -382
   ypos 350
  }
  FFT {
   channels rgba
   normalize_input true
   center_kernel true
   name FFT1
   xpos -382
   ypos 395
  }
  FFTMultiply {
   inputs 2
   name FFTMultiply1
   xpos -382
   ypos 442
  }
set Na4e21800 [stack 0]
  InvFFT {
   name InvFFT1
   xpos -382
   ypos 478
  }
  Dot {
   name Dot4
   xpos -348
   ypos 548
  }
  Dot {
   name Dot6
   xpos -138
   ypos 548
  }
set Na4e20c00 [stack 0]
  Dot {
   name Dot7
   xpos 15
   ypos 548
  }
push $Na4e23800
  Dot {
   name Dot13
   xpos 170
   ypos 59
  }
  Dot {
   name Dot15
   xpos 170
   ypos 415
  }
set Na4ddbc00 [stack 0]
  Dot {
   name Dot5
   xpos 34
   ypos 501
  }
set Na4ddb800 [stack 0]
  Copy {
   inputs 2
   channels rgba
   name Copy3
   xpos 0
   ypos 581
  }
  Input {
   inputs 0
   name mask
   selected true
   xpos 210
   ypos 587
   number 2
  }
push $Na4e20c00
push $Na4ddb800
  Dot {
   name Dot8
   xpos -68
   ypos 501
  }
  Copy {
   inputs 2+1
   channels rgb
   mix 0.48
   name Copy2
   xpos -102
   ypos 589
  }
  Switch {
   inputs 2
   which {{parent.c}}
   name Switch2
   xpos 0
   ypos 668
  }
  Reformat {
   type "to box"
   box_width {{ImgIn.width}}
   box_height {{ImgIn.height}}
   resize none
   name ReformatOutput
   xpos 0
   ypos 692
  }
  Switch {
   inputs 2
   which {{parent.output}}
   name Switch3
   xpos 0
   ypos 742
  }
push $Na4ddbc00
  Dot {
   name Dot14
   xpos 170
   ypos 804
  }
  Dissolve {
   inputs 2
   channels rgba
   which {{parent.mix}}
   name Dissolve1
   xpos 0
   ypos 801
  }
set Na4dd9000 [stack 0]
push $Na4e21800
  Viewer {
   inputs 2
   frame_range 1-4473
   name Viewer1
   xpos -449
   ypos 621
  }
push $Na4dd9000
  Output {
   name Output1
   xpos 0
   ypos 871
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read1
   xpos -568
   ypos -43
  }
 end_group
 Dot {
  name Dot68
  xpos -1371
  ypos 7
 }
set Na4d73c00 [stack 0]
 Dot {
  name Dot66
  xpos -1040
  ypos 7
 }
 Dot {
  name Dot65
  xpos -1040
  ypos 268
 }
push 0
push $Na3bb3800
push $Na4eadc00
push $Na4eac400
 Colorspace {
  colorspace_in REDLog
  name Colorspace2
  xpos -1135
  ypos 138
 }
 Group {
  inputs 3
  name LensKernelFFT3
  tile_color 0xff7f28ff
  xpos -1135
  ypos 164
  addUserKnob {20 User}
  addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
  addUserKnob {4 c l channels M {RGB RGBA ""}}
  addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
  addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
  addUserKnob {7 mix}
  mix 1
  addUserKnob {20 Kernels}
  addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
  addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
  addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
 }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read3
   xpos -184
   ypos -88
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read2
   xpos -387
   ypos -128
  }
  Input {
   inputs 0
   name Input2
   xpos -672
   ypos 46
   number 1
  }
  Switch {
   inputs 3
   which {{parent.kernel}}
   name Switch1
   xpos -382
   ypos 91
  }
  Transform {
   translate {1 0}
   center {1954 1301}
   name Transform
   label recenter
   xpos -382
   ypos 122
   disable true
  }
  Dot {
   name Dot1
   xpos -348
   ypos 170
  }
set Na4d71000 [stack 0]
  Dot {
   name Dot2
   xpos -238
   ypos 170
  }
  Saturation {
   saturation 0
   name Saturation
   label luminance
   xpos -272
   ypos 224
  }
push $Na4d71000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.alpha
   name Copy
   label luminance->alpha
   xpos -382
   ypos 218
  }
  Dot {
   name Dot10
   xpos -348
   ypos 272
  }
set Na4d17c00 [stack 0]
  Dot {
   name Dot9
   xpos -458
   ypos 272
  }
  Dot {
   name Dot11
   xpos -458
   ypos 745
  }
  Input {
   inputs 0
   name Input1
   xpos 0
   ypos -11
  }
  NoOp {
   name ImgIn
   xpos 0
   ypos 13
  }
  Dot {
   name Dot12
   xpos 34
   ypos 59
  }
set Na4d16800 [stack 0]
  Reformat {
   type "to box"
   box_width {{"width + (2* parent.pad)"}}
   box_height {{"height + (2* parent.pad)"}}
   resize none
   name Reformat_PadFrame
   xpos 0
   ypos 349
  }
  FFT {
   channels rgba
   name FFT2
   xpos 0
   ypos 395
  }
  Dot {
   name Dot3
   xpos 34
   ypos 451
  }
push $Na4d17c00
  Reformat {
   type "to box"
   box_width {{LensKernelFFT3.Reformat_PadFrame.box_width.main}}
   box_height {{LensKernelFFT3.Reformat_PadFrame.box_height.main}}
   resize none
   name ReformatKernel
   xpos -382
   ypos 350
  }
  FFT {
   channels rgba
   normalize_input true
   center_kernel true
   name FFT1
   xpos -382
   ypos 395
  }
  FFTMultiply {
   inputs 2
   name FFTMultiply1
   xpos -382
   ypos 442
  }
set Na4d14800 [stack 0]
  InvFFT {
   name InvFFT1
   xpos -382
   ypos 478
  }
  Dot {
   name Dot4
   xpos -348
   ypos 548
  }
  Dot {
   name Dot6
   xpos -138
   ypos 548
  }
set Na4cdb800 [stack 0]
  Dot {
   name Dot7
   xpos 15
   ypos 548
  }
push $Na4d16800
  Dot {
   name Dot13
   xpos 170
   ypos 59
  }
  Dot {
   name Dot15
   xpos 170
   ypos 415
  }
set Na4cdac00 [stack 0]
  Dot {
   name Dot5
   xpos 34
   ypos 501
  }
set Na4cda800 [stack 0]
  Copy {
   inputs 2
   channels rgba
   name Copy3
   xpos 0
   ypos 581
  }
  Input {
   inputs 0
   name mask
   selected true
   xpos 314
   ypos 600
   number 2
  }
push $Na4cdb800
push $Na4cda800
  Dot {
   name Dot8
   xpos -68
   ypos 501
  }
  Copy {
   inputs 2+1
   channels rgb
   mix 0.48
   name Copy2
   xpos -102
   ypos 588
  }
  Switch {
   inputs 2
   which {{parent.c}}
   name Switch2
   xpos 0
   ypos 668
  }
  Reformat {
   type "to box"
   box_width {{ImgIn.width}}
   box_height {{ImgIn.height}}
   resize none
   name ReformatOutput
   xpos 0
   ypos 692
  }
  Switch {
   inputs 2
   which {{parent.output}}
   name Switch3
   xpos 0
   ypos 742
  }
push $Na4cdac00
  Dot {
   name Dot14
   xpos 170
   ypos 804
  }
  Dissolve {
   inputs 2
   channels rgba
   which {{parent.mix}}
   name Dissolve1
   xpos 0
   ypos 801
  }
set Na4c9bc00 [stack 0]
push $Na4d14800
  Viewer {
   inputs 2
   frame_range 1-4473
   name Viewer1
   xpos -449
   ypos 621
  }
push $Na4c9bc00
  Output {
   name Output1
   xpos 0
   ypos 871
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read1
   xpos -568
   ypos -43
  }
 end_group
 Colorspace {
  colorspace_out REDLog
  name Colorspace5
  xpos -1135
  ypos 202
 }
push $Na3bb3800
push $Na4eadc00
 Dot {
  name Dot70
  xpos -1446
  ypos 92
 }
push $Na4d73c00
 Dot {
  name Dot69
  xpos -1481
  ypos 7
 }
 Colorspace {
  colorspace_in REDLog
  name Colorspace1
  xpos -1514
  ypos 43
 }
 Colorspace {
  colorspace_in REDLog
  name Colorspace6
  xpos -1624
  ypos 43
 }
 Group {
  inputs 3
  name LensKernelFFT2
  tile_color 0xff7f28ff
  xpos -1624
  ypos 83
  addUserKnob {20 User}
  addUserKnob {4 output M {"convolution result" "input kernel" "" ""}}
  addUserKnob {4 c l channels M {RGB RGBA ""}}
  addUserKnob {4 kernel M {"35mm f1.4" "35mm f2.8" "35mm f5.6"}}
  addUserKnob {3 pad l "pad frame" t "If bright areas of the convolved image 'wrap around' to the other side of the image, padding the frame will alleviate this problem. Also, if the bounding extends beyond the image, setting this to a larger size than 0 will allow you to reserve it. value is in pixels.\n"}
  addUserKnob {7 mix}
  mix 1
  addUserKnob {20 Kernels}
  addUserKnob {41 kernel14 l "35mm f1.4 kernel" T Read1.file}
  addUserKnob {41 kernel28 l "35mm f2.8 kernel" T Read2.file}
  addUserKnob {41 kernel56 l "35mm f5.6 kernel" T Read3.file}
 }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read3
   xpos -184
   ypos -88
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read2
   xpos -387
   ypos -128
  }
  Input {
   inputs 0
   name Input2
   xpos -672
   ypos 46
   number 1
  }
  Switch {
   inputs 3
   which {{parent.kernel}}
   name Switch1
   xpos -382
   ypos 91
  }
  Transform {
   translate {1 0}
   center {1954 1301}
   name Transform
   label recenter
   xpos -382
   ypos 122
   disable true
  }
  Dot {
   name Dot1
   xpos -348
   ypos 170
  }
set Na4c2f800 [stack 0]
  Dot {
   name Dot2
   xpos -238
   ypos 170
  }
  Saturation {
   saturation 0
   name Saturation
   label luminance
   xpos -272
   ypos 224
  }
push $Na4c2f800
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.alpha
   name Copy
   label luminance->alpha
   xpos -382
   ypos 218
  }
  Dot {
   name Dot10
   xpos -348
   ypos 272
  }
set Na4c2e800 [stack 0]
  Dot {
   name Dot9
   xpos -458
   ypos 272
  }
  Dot {
   name Dot11
   xpos -458
   ypos 745
  }
  Input {
   inputs 0
   name Input1
   xpos 0
   ypos -11
  }
  NoOp {
   name ImgIn
   xpos 0
   ypos 13
  }
  Dot {
   name Dot12
   xpos 34
   ypos 59
  }
set Na4c2d400 [stack 0]
  Reformat {
   type "to box"
   box_width {{"width + (2* parent.pad)"}}
   box_height {{"height + (2* parent.pad)"}}
   resize none
   name Reformat_PadFrame
   xpos 0
   ypos 349
  }
  FFT {
   channels rgba
   name FFT2
   xpos 0
   ypos 395
  }
  Dot {
   name Dot3
   xpos 34
   ypos 451
  }
push $Na4c2e800
  Reformat {
   type "to box"
   box_width {{LensKernelFFT2.Reformat_PadFrame.box_width.main}}
   box_height {{LensKernelFFT2.Reformat_PadFrame.box_height.main}}
   resize none
   name ReformatKernel
   xpos -382
   ypos 350
  }
  FFT {
   channels rgba
   normalize_input true
   center_kernel true
   name FFT1
   xpos -382
   ypos 395
  }
  FFTMultiply {
   inputs 2
   name FFTMultiply1
   xpos -382
   ypos 442
  }
set Na4fdf000 [stack 0]
  InvFFT {
   name InvFFT1
   xpos -382
   ypos 478
  }
  Dot {
   name Dot4
   xpos -348
   ypos 548
  }
  Dot {
   name Dot6
   xpos -138
   ypos 548
  }
set Na4fde400 [stack 0]
  Dot {
   name Dot7
   xpos 15
   ypos 548
  }
push $Na4c2d400
  Dot {
   name Dot13
   xpos 170
   ypos 59
  }
  Dot {
   name Dot15
   xpos 170
   ypos 415
  }
set Na4fdd800 [stack 0]
  Dot {
   name Dot5
   xpos 34
   ypos 501
  }
set Na4fdd400 [stack 0]
  Copy {
   inputs 2
   channels rgba
   name Copy3
   xpos 0
   ypos 581
  }
  Input {
   inputs 0
   name mask
   selected true
   xpos 364
   ypos 597
   number 2
  }
push $Na4fde400
push $Na4fdd400
  Dot {
   name Dot8
   xpos -68
   ypos 501
  }
  Copy {
   inputs 2+1
   channels rgb
   mix 0.48
   name Copy2
   xpos -102
   ypos 589
  }
  Switch {
   inputs 2
   which {{parent.c}}
   name Switch2
   xpos 0
   ypos 668
  }
  Reformat {
   type "to box"
   box_width {{ImgIn.width}}
   box_height {{ImgIn.height}}
   resize none
   name ReformatOutput
   xpos 0
   ypos 692
  }
  Switch {
   inputs 2
   which {{parent.output}}
   name Switch3
   xpos 0
   ypos 742
  }
push $Na4fdd800
  Dot {
   name Dot14
   xpos 170
   ypos 804
  }
  Dissolve {
   inputs 2
   channels rgba
   which {{parent.mix}}
   name Dissolve1
   xpos 0
   ypos 801
  }
set Na4f96800 [stack 0]
push $Na4fdf000
  Viewer {
   inputs 2
   frame_range 1-4473
   name Viewer1
   xpos -449
   ypos 621
  }
push $Na4f96800
  Output {
   name Output1
   xpos 0
   ypos 871
  }
  Read {
   inputs 0
   file_type exr
   format "3908 2602 0 0 3908 2602 1 "
   origset true
   in_colorspace scene_linear
   out_colorspace scene_linear
   name Read1
   xpos -568
   ypos -43
  }
 end_group
 Colorspace {
  colorspace_out REDLog
  name Colorspace11
  xpos -1624
  ypos 144
 }
 Colorspace {
  colorspace_out REDLog
  name Colorspace12
  xpos -1514
  ypos 144
 }
 Dot {
  name Dot71
  xpos -1480
  ypos 268
 }
 Dissolve {
  inputs 3+1
  which {{"2 - (parent.double)"}}
  name Dissolve1
  xpos -1135
  ypos 259
 }
 Transform {
  scale {{parent.Transform1.scale}}
  center {960 540}
  invert_matrix true
  name Transform2
  xpos -1135
  ypos 322
  disable {{parent.bleeding==0}}
 }
 Shuffle {
  name Shuffle1
  xpos -1135
  ypos 363
 }
 Crop {
  box {0 0 {Input.width} {Input.height}}
  reformat true
  crop false
  name Crop1
  xpos -1135
  ypos 407
 }
 Dot {
  name Dot40
  xpos -1101
  ypos 464
 }
push $Na3bb3000
 Shuffle {
  alpha black
  black black
  white black
  red2 black
  green2 black
  name Shuffle5
  xpos -158
  ypos -281
 }
 Dot {
  name Dot1
  xpos -61
  ypos -277
 }
set Na4f2f000 [stack 0]
 Dot {
  name Dot34
  xpos 71
  ypos -277
 }
set Na4f2ec00 [stack 0]
 Dot {
  name Dot28
  xpos 68
  ypos 153
 }
set Na4f2e800 [stack 0]
 Dot {
  name Dot72
  xpos -968
  ypos 147
 }
 Merge2 {
  inputs 2
  operation minus
  name Merge9
  xpos -1002
  ypos 460
 }
 Saturation {
  saturation {{parent.Saturation}}
  mode Maximum
  name Saturation1
  selected true
  xpos -903
  ypos 460
 }
 Clamp {
  maximum_enable false
  name Clamp1
  xpos -903
  ypos 508
 }
 Dot {
  name Dot51
  xpos -869
  ypos 568
 }
 Expression {
  temp_name0 first
  temp_expr0 "\t (  (b>g) ? r*(wht.r-cyn.r) + g*(cyn.r-blu.r) + b*blu.r : ( (b>r) ? r*(wht.r-cyn.r) + g*grn.r + b*(cyn.r-grn.r) : r*(yel.r-grn.r) + g*grn.r + b*(wht.r-yel.r) ) )\n"
  temp_name1 second
  temp_expr1 "\t (  (b>g) ? r*(wht.g-cyn.g) + g*(cyn.g-blu.g) + b*blu.g : ( (b>r) ? r*(wht.g-cyn.g) + g*grn.g + b*(cyn.g-grn.g) : r*(yel.g-grn.g) + g*grn.g + b*(wht.g-yel.g) ) )\n"
  temp_name2 third
  temp_expr2 "\t (  (b>g) ? r*(wht.b-cyn.b) + g*(cyn.b-blu.b) + b*blu.b : ( (b>r) ? r*(wht.b-cyn.b) + g*grn.b + b*(cyn.b-grn.b) : r*(yel.b-grn.b) + g*grn.b + b*(wht.b-yel.b) ) )"
  expr0 "\t(r>g) ? ( (g>b) ? r*red.r + g*(yel.r-red.r) + b*(wht.r-yel.r) : ( (r>b) ? r*red.r + g*(wht.r-mag.r) + b*(mag.r-red.r) : r*(mag.r-blu.r) + g*(wht.r-mag.r) + b*blu.r ) ) \n\t:\n\tfirst"
  expr1 "\t(r>g) ? ( (g>b) ? r*red.g + g*(yel.g-red.g) + b*(wht.g-yel.g) : ( (r>b) ? r*red.g + g*(wht.g-mag.g) + b*(mag.g-red.g) : r*(mag.g-blu.g) + g*(wht.g-mag.g) + b*blu.g ) ) \n\t:\n\tsecond"
  expr2 "\t(r>g) ? ( (g>b) ? r*red.b + g*(yel.b-red.b) + b*(wht.b-yel.b) : ( (r>b) ? r*red.b + g*(wht.b-mag.b) + b*(mag.b-red.b) : r*(mag.b-blu.b) + g*(wht.b-mag.b) + b*blu.b ) ) \n\t:\n\tthird"
  name Expression1
  xpos -789
  ypos 564
  disable {{parent.greens==0}}
  addUserKnob {20 User}
  addUserKnob {18 wht l 1}
  wht {1 1 1}
  addUserKnob {6 wht_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 red l 2}
  red {1 0 0}
  addUserKnob {6 red_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_1_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 grn l 3}
  grn {1 1 0}
  addUserKnob {6 grn_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_2_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 blu l 4}
  blu {0 0 1}
  addUserKnob {6 blu_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_3_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 cyn l 5}
  cyn {1 1 1}
  addUserKnob {6 cyn_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_4_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 mag l 6}
  mag {1 0 1}
  addUserKnob {6 mag_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_5_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 yel l 7}
  yel {1 1 0}
  addUserKnob {6 yel_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 color_rgb_6_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
 }
 Group {
  name GamutCompress
  xpos -789
  ypos 530
  disable {{"Saturation ? Saturation < 1.0001 : false"}}
  addUserKnob {20 GamutCompress}
  addUserKnob {41 threshold t "Percentage of the outer gamut boundary to affect. A value of 0.2 means 20% of the outer gamut will be utilized for gamut compression." T compress.threshold}
  addUserKnob {41 power t "Adjust the exponent of the compression function. 1 = Reinhard. Higher values have C2 continuity and result in a more \"aggressive\" curve which preserves more color purity or saturation.\n\nBe wary of high values if accurate inv\nersion is important to you." T compress.power}
  addUserKnob {7 shd_rolloff l "shd rolloff" t "Shadow rolloff reduces the gamut compression effect below the specified pixel value. This reduces invertability issues with negative pixels in shadow grain." R 0 0.1}
  shd_rolloff 0.0165
  addUserKnob {26 distance_limit_label l " " t "Specifies the maximum distance beyond the gamut boundary to map to the gamut boundary for each color component." T "<b>max distance limit"}
  addUserKnob {41 cyan t "Maximum distance beyond the green-blue gamut boundary to compress to the gamut boundary." T compress.cyan}
  addUserKnob {41 magenta t "Maximum distance beyond the blue-red gamut boundary to compress to the gamut boundary." T compress.magenta}
  addUserKnob {41 yellow t "Maximum distance beyond the red-green gamut boundary to compress to the gamut boundary." T compress.yellow}
  addUserKnob {22 reset t "Reset knobs to default values. Distance limits are calculated based on an the average of a selection of digital cinema cameras." T "n = nuke.thisNode()\nnuke.root().begin()\ndefaults = \{\n    'threshold': 0.2,\n    'power': 1.2,\n    'shd_rolloff': 0.03,\n    'cyan': 0.09,\n    'magenta':0.24,\n    'yellow': 0.12,\n\}\nfor k, v in defaults.items():\n    n\[k].setValue(v)" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {20 info_tab l Info}
  addUserKnob {26 info_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc>\n<b>GamutCompress</b><br>\nmaps out of gamut colors back into gamut.\n<br><br><a href=https://github.com/jedypod/gamut-compress>Documentation</a>"}
  addUserKnob {26 about_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc><br>\n<b>About</b><br>\nWritten by <a href=https://github.com/jedypod color=red>Jed Smith</a> <br> with <a href=https://community.acescentral.com/t/rgb-saturation-gamut-mapping-approach-and-a-comp-vfx-perspective>help</a> from the <a href=https://community.acescentral.com/c/aces-development-acesnext/vwg-aces-gamut-mapping-working-group>ACES Gamut Mapping VWG</a>"}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -274
  }
  Dot {
   name Dot4
   xpos -6
   ypos -174
  }
set Na4f2cc00 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos -174
  }
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 max(r,g,b)
   name achromatic
   xpos -260
   ypos -130
  }
set Na4f2c400 [stack 0]
  Dot {
   name Dot1
   xpos -226
   ypos -78
  }
set Na52d3c00 [stack 0]
  Dot {
   name Dot3
   xpos -226
   ypos 114
  }
push $Na52d3c00
  Expression {
   temp_name0 c_r
   temp_expr0 1-r
   temp_name1 c_g
   temp_expr1 1-g
   temp_name2 c_b
   temp_expr2 1-b
   expr0 1-(c_r<(1-thr)?c_r:(1-thr)+thr*tanh(((c_r-(1-thr))/thr)))
   expr1 1-(c_g<(1-thr)?c_g:(1-thr)+thr*tanh(((c_g-(1-thr))/thr)))
   expr2 1-(c_b<(1-thr)?c_b:(1-thr)+thr*tanh(((c_b-(1-thr))/thr)))
   name toe
   xpos -150
   ypos -82
   disable {{parent.shd_rolloff==0}}
   addUserKnob {20 Params_tab l Params}
   addUserKnob {7 thr t "complement of threshold"}
   thr {{parent.shd_rolloff}}
  }
set Na52d3400 [stack 0]
  Dot {
   name Dot7
   xpos -116
   ypos 66
  }
push $Na4f2c400
push $Na4f2cc00
  Merge2 {
   inputs 2
   operation minus
   bbox B
   Achannels rgb
   Bchannels rgb
   output rgb
   name Merge1
   xpos -40
   ypos -130
  }
push $Na52d3400
  Merge2 {
   inputs 2
   operation divide
   bbox B
   Achannels rgb
   Bchannels rgb
   output rgb
   name Merge2
   xpos -40
   ypos -82
  }
  Group {
   name compress
   xpos -40
   ypos -10
   addUserKnob {20 compress}
   addUserKnob {18 threshold}
   threshold 0.29
   addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 power R 1 5}
   power 1.2
   addUserKnob {7 cyan}
   cyan 1
   addUserKnob {7 magenta}
   magenta 0.2
   addUserKnob {7 yellow}
   yellow 0.125
   addUserKnob {26 ""}
   addUserKnob {6 invert +STARTLINE}
   invert {{parent.direction}}
  }
   Input {
    inputs 0
    name Input
    xpos -260
    ypos -250
   }
set Na52d2400 [stack 0]
   Expression {
    temp_name0 s_x
    temp_expr0 (lim_x-thr_x)/pow(pow((1-thr_x)/(lim_x-thr_x),-p)-1,1/p)
    temp_name1 s_y
    temp_expr1 (lim_y-thr_y)/pow(pow((1-thr_y)/(lim_y-thr_y),-p)-1,1/p)
    temp_name2 s_z
    temp_expr2 (lim_z-thr_z)/pow(pow((1-thr_z)/(lim_z-thr_z),-p)-1,1/p)
    expr0 r<thr_x||lim_x<1.0001?r:r>(thr_x+s_x)?r:thr_x+s_x*pow(-(pow((r-thr_x)/s_x,p)/(pow((r-thr_x)/s_x,p)-1)),1/p)
    expr1 g<thr_y||lim_y<1.0001?g:g>(thr_y+s_y)?g:thr_y+s_y*pow(-(pow((g-thr_y)/s_y,p)/(pow((g-thr_y)/s_y,p)-1)),1/p)
    expr2 b<thr_z||lim_z<1.0001?b:b>(thr_z+s_z)?b:thr_z+s_z*pow(-(pow((b-thr_z)/s_z,p)/(pow((b-thr_z)/s_z,p)-1)),1/p)
    name uncompress
    xpos -150
    ypos -202
    addUserKnob {20 Params_tab l Params}
    addUserKnob {7 thr_x}
    thr_x {{1-parent.threshold.r}}
    addUserKnob {7 thr_y}
    thr_y {{1-parent.threshold.g}}
    addUserKnob {7 thr_z}
    thr_z {{1-parent.threshold.b}}
    addUserKnob {7 lim_x}
    lim_x {{parent.cyan+1}}
    addUserKnob {7 lim_y}
    lim_y {{parent.magenta+1}}
    addUserKnob {7 lim_z}
    lim_z {{parent.yellow+1}}
    addUserKnob {7 p R 1 5}
    p {{parent.power}}
   }
push $Na52d2400
   Expression {
    temp_name0 s_x
    temp_expr0 (lim_x-thr_x)/pow(pow((1-thr_x)/(lim_x-thr_x),-p)-1,1/p)
    temp_name1 s_y
    temp_expr1 (lim_y-thr_y)/pow(pow((1-thr_y)/(lim_y-thr_y),-p)-1,1/p)
    temp_name2 s_z
    temp_expr2 (lim_z-thr_z)/pow(pow((1-thr_z)/(lim_z-thr_z),-p)-1,1/p)
    expr0 r<thr_x||lim_x<1.0001?r:thr_x+s_x*((r-thr_x)/s_x)/(pow(1+pow((r-thr_x)/s_x,p),1/p))
    expr1 g<thr_y||lim_y<1.0001?g:thr_y+s_y*((g-thr_y)/s_y)/(pow(1+pow((g-thr_y)/s_y,p),1/p))
    expr2 b<thr_z||lim_z<1.0001?b:thr_z+s_z*((b-thr_z)/s_z)/(pow(1+pow((b-thr_z)/s_z,p),1/p))
    name compress
    xpos -370
    ypos -202
    addUserKnob {20 Params_tab l Params}
    addUserKnob {7 thr_x}
    thr_x {{1-parent.threshold.r}}
    addUserKnob {7 thr_y}
    thr_y {{1-parent.threshold.g}}
    addUserKnob {7 thr_z}
    thr_z {{1-parent.threshold.b}}
    addUserKnob {7 lim_x}
    lim_x {{parent.cyan+1}}
    addUserKnob {7 lim_y}
    lim_y {{parent.magenta+1}}
    addUserKnob {7 lim_z}
    lim_z {{parent.yellow+1}}
    addUserKnob {7 p R 1 5}
    p {{parent.power}}
   }
   Switch {
    inputs 2
    which {{parent.invert}}
    name switch_direction
    xpos -260
    ypos -154
   }
   Output {
    name Output
    xpos -260
    ypos -106
   }
  end_group
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   Achannels rgb
   Bchannels rgb
   output rgb
   name Merge3
   xpos -40
   ypos 62
  }
  Merge2 {
   inputs 2
   operation minus
   bbox B
   Achannels rgb
   Bchannels rgb
   output rgb
   name Merge5
   xpos -40
   ypos 110
  }
  Output {
   name Output
   xpos -40
   ypos 182
  }
 end_group
push $Na4f2e800
 Dot {
  name Dot61
  xpos -755
  ypos 153
 }
 Blur {
  size 1
  name Blur6
  xpos -789
  ypos 417
 }
 Merge2 {
  inputs 2
  operation plus
  name Merge10
  xpos -789
  ypos 460
 }
 Dot {
  name Dot42
  xpos -282
  ypos 464
 }
 Dot {
  name Dot46
  xpos -282
  ypos 277
 }
push $Na3bc4c00
 Dot {
  name Dot67
  xpos -581
  ypos -19
 }
 Dot {
  name Dot17
  xpos -581
  ypos 185
 }
set Na526a800 [stack 0]
 Dot {
  name Dot43
  xpos -695
  ypos 185
 }
set Na526a400 [stack 0]
 Dot {
  name Dot25
  xpos -837
  ypos 185
 }
 Dot {
  name Dot35
  xpos -837
  ypos 333
 }
set Na5269c00 [stack 0]
 Dot {
  name Dot21
  xpos -837
  ypos 361
 }
set Na5269800 [stack 0]
 Dot {
  name Dot22
  xpos -837
  ypos 385
 }
push $Na5269800
push $Na5269c00
push $Na526a400
 Dot {
  name Dot6
  xpos -695
  ypos 229
 }
set Na5269000 [stack 0]
 Dot {
  name Dot7
  xpos -695
  ypos 271
 }
set Na5268c00 [stack 0]
 Dot {
  name Dot8
  xpos -695
  ypos 311
 }
set Na5268800 [stack 0]
push $Na5268800
push $Na5268c00
push 0
push $Na5269000
push 0
push $Na4f2f000
 Colorspace {
  colorspace_in REDLog
  name Colorspace8
  xpos -95
  ypos -161
 }
 Dot {
  name Dot41
  xpos -61
  ypos -35
 }
 Dot {
  name Dot11
  xpos -521
  ypos -35
 }
 Dot {
  name Dot2
  xpos -521
  ypos 229
 }
set Na5233400 [stack 0]
 Group {
  inputs 3
  name red
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -637
  ypos 220
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.Blur.r*0.5}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 3.3
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  effect_only {{parent.soft==0}}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 5
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na5232000 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na5231c00 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na5231c00
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na51d7400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na51d6c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na51d7400
push $Na51d6c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na5232000
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na51d4400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na51d4400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan x1 0} {parent.crop?0:-parent.overscan x1 0} {parent.crop?width:width+parent.overscan x1 1372} {parent.crop?height:height+parent.overscan x1 900}}
   intersect true
   name CropOverscan
   selected true
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  inputs 3
  name green
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -637
  ypos 262
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.Blur.g*0.5}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 3.2
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 5
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na5174c00 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na5174800 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na5174800
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na5132000 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na5131800 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na5132000
push $Na5131800
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na5174c00
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na50bec00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na50bec00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  inputs 3
  name blue
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -637
  ypos 302
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.Blur.b*0.5}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 1.25
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  effect_only {{parent.soft==0}}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.Blur.b}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff 5
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na5067400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na5067000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na5067000
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na5064c00 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na5064400 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na5064c00
push $Na5064400
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   selected true
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na5067400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na5021800 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na5021800
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
set Na50e8800 [stack 0]
 Dot {
  name Dot33
  xpos -603
  ypos 333
 }
 FilterErode {
  inputs 1+1
  channels {rgba.red -rgba.green -rgba.blue -rgba.alpha}
  size {{parent.Erode.r}}
  filter gaussian
  name ErodeRed1
  xpos -793
  ypos 330
 }
 FilterErode {
  inputs 1+1
  channels {-rgba.red rgba.green -rgba.blue -rgba.alpha}
  size {{parent.Erode.g}}
  filter gaussian
  name ErodeGreen1
  xpos -793
  ypos 358
 }
 FilterErode {
  inputs 1+1
  channels {-rgba.red -rgba.green rgba.blue -rgba.alpha}
  size {{parent.Erode.b}}
  filter gaussian
  name ErodeBlue1
  xpos -793
  ypos 382
 }
 Dot {
  name Dot29
  xpos -759
  ypos 38
 }
 Dot {
  name Dot49
  xpos -162
  ypos 38
 }
push $Na5268800
 Dot {
  name Dot4
  xpos -695
  ypos 358
 }
set Na53b1800 [stack 0]
 Dot {
  name Dot13
  xpos -695
  ypos 386
 }
set Na53b1400 [stack 0]
 Dot {
  name Dot16
  xpos -695
  ypos 410
 }
push $Na53b1400
push $Na53b1800
push $Na5233400
 Dot {
  name Dot5
  xpos -521
  ypos 358
 }
 FilterErode {
  inputs 1+1
  channels {rgba.red -rgba.green -rgba.blue -rgba.alpha}
  size {{parent.Erode.r}}
  filter gaussian
  name ErodeRed
  xpos -637
  ypos 355
 }
 FilterErode {
  inputs 1+1
  channels {-rgba.red rgba.green -rgba.blue -rgba.alpha}
  size {{parent.Erode.g}}
  filter gaussian
  name ErodeGreen
  xpos -637
  ypos 383
 }
 FilterErode {
  inputs 1+1
  channels {-rgba.red -rgba.green rgba.blue -rgba.alpha}
  size {{parent.Erode.b}}
  filter gaussian
  name ErodeBlue
  xpos -637
  ypos 407
 }
 Dot {
  name Dot14
  xpos -603
  ypos 488
 }
 Dot {
  name Dot24
  xpos -338
  ypos 488
 }
 Dot {
  name Dot50
  xpos -338
  ypos 51
 }
 Dot {
  name Dot26
  xpos -162
  ypos 51
 }
push $Na50e8800
 Dot {
  name Dot44
  xpos -421
  ypos 311
 }
 Dot {
  name Dot48
  xpos -421
  ypos 25
 }
 Dot {
  name Dot12
  xpos -162
  ypos 25
 }
 Switch {
  inputs 3
  name Switch1
  xpos -100
  ypos 22
 }
 Colorspace {
  colorspace_out REDLog
  name Colorspace7
  xpos -100
  ypos 79
 }
push $Na4f2e800
 Merge2 {
  inputs 2
  operation minus
  name Merge5
  xpos -99
  ypos 150
 }
 ColorCorrect {
  gain {{parent.double}}
  name ColorCorrect2
  xpos -99
  ypos 203
 }
push $Na4f2e800
 Dot {
  name Dot31
  xpos 68
  ypos 236
 }
set Na5360c00 [stack 0]
 Merge2 {
  inputs 2
  name Merge6
  xpos -99
  ypos 233
 }
push $Na526a800
 Premult {
  name Premult1
  xpos 176
  ypos 182
 }
 Dot {
  name Dot18
  xpos 210
  ypos 113
 }
 FilterErode {
  channels {rgba.red -rgba.green -rgba.blue none}
  size {{parent.Erode.r}}
  filter gaussian
  name FilterErode2
  xpos 263
  ypos 110
 }
 FilterErode {
  channels {-rgba.red rgba.green -rgba.blue none}
  size {{parent.Erode.g}}
  filter gaussian
  name FilterErode3
  xpos 263
  ypos 139
 }
 FilterErode {
  channels {-rgba.red -rgba.green rgba.blue none}
  size {{parent.Erode.b}}
  filter gaussian
  name FilterErode4
  xpos 263
  ypos 163
 }
 Blur {
  channels {rgba.red -rgba.green -rgba.blue none}
  size {{parent.Blur.r}}
  mix 0.285
  name Blur2
  xpos 263
  ypos 187
 }
 Blur {
  channels {-rgba.red rgba.green -rgba.blue none}
  size {{parent.Blur.g}}
  name Blur3
  xpos 263
  ypos 215
 }
 Blur {
  channels {-rgba.red -rgba.green rgba.blue none}
  size {{parent.Blur.b}}
  name Blur4
  xpos 263
  ypos 245
 }
push $Na4f2ec00
 Dot {
  name Dot32
  xpos 297
  ypos -277
 }
 Dot {
  name Dot15
  xpos 297
  ypos 4
 }
set Na5311c00 [stack 0]
 Dot {
  name Dot19
  xpos 431
  ypos 4
 }
 Colorspace {
  colorspace_in Panalog
  name Colorspace3
  xpos 397
  ypos 93
 }
 Merge2 {
  inputs 2
  mix 0.25
  name Merge3
  xpos 397
  ypos 245
 }
 Colorspace {
  colorspace_out Panalog
  name Colorspace4
  xpos 397
  ypos 274
 }
 Switch {
  inputs 3
  which 2
  name Switch2
  xpos -100
  ypos 274
 }
push $Na5360c00
 Dot {
  name Dot30
  xpos 68
  ypos 331
 }
set Na5310400 [stack 0]
 Merge2 {
  inputs 2
  operation minus
  maskChannelInput -rgba.alpha
  invert_mask true
  name Merge2
  xpos -100
  ypos 328
 }
 Group {
  name apGlow
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -230
  ypos 322
  disable {{parent.glow==0}}
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.glow_intensity.r}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 1
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.glow_radius.r}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff {{parent.glow_falloff.r}}
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na56aa800 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na56aa400 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na56aa400
  Remove {
   operation keep
   channels {rgba.red -rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na5653c00 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na5653400 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na5653c00
push $Na5653400
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na56aa800
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na5650c00 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na5650c00
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow1
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -230
  ypos 410
  disable {{parent.glow==0}}
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.glow_intensity.g}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 1
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.glow_radius.g}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff {{parent.glow_falloff.g}}
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {6 enableOverscan l enable -STARTLINE +DISABLED}
  enableOverscan true
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na55e5400 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na55e5000 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na55e5000
  Remove {
   operation keep
   channels {-rgba.red rgba.green -rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na5596800 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na5596000 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na5596800
push $Na5596000
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na55e5400
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na552f400 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na552f400
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 Group {
  name apGlow2
  help "apGlow v1.1 by Adrian Pueyo\n\nExponential glow using a sub-frame iterative blur.\n\nWith the \"area\" input (optional) you can set only a part of the image to emit glow.\n\nCaveats:\n- This node will kill sub-frames as it relies on a floor NoTimeBlur. Do any other sub-frame operations before this!\n- NaN's will be turned black, but on rgba only.\n\nadrianpueyo.com, 2015-2018"
  onCreate "n = nuke.thisNode()\nfor i in \['intensity','response','max_size','src_black','src_white','response']:\n    n\[i].setFlag(0x00000004)\nn\['max_size'].setRange(0,10000)\nn\['overscan'].setRange(0,1000)"
  knobChanged "n = nuke.thisNode()\nk = nuke.thisKnob()\nif k.name() in \[\"crop\",\"enableOverscan\"]:\n    kcv = n\[\"crop\"].value()\n    kov = n\[\"enableOverscan\"].value()\n    n\[\"enableOverscan\"].setEnabled(not kcv)\n    n\['overscan'].setEnabled(not kcv and kov)"
  tile_color 0xe88543ff
  xpos -98
  ypos 410
  disable {{parent.glow==0}}
  addUserKnob {20 apGlow}
  addUserKnob {41 channels T KeepWhat.channels}
  addUserKnob {7 intensity t "Intensity multiplier for the resulting glow." R 0 10}
  intensity {{parent.glow_intensity.b}}
  addUserKnob {18 persistance t "Color gain of the largest step. Affects the other steps progressively, with 0 effect on the smallest one.\n\nUse as an inverse falloff or as a progressive color tint." R 0 10}
  persistance 1
  addUserKnob {6 persistance_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 persistance_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 tint t "Overall color multiplier for the intensity."}
  tint 1
  addUserKnob {6 tint_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 tint_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {6 effect_only l "effect only" +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {7 src_black l "src black" t "Black point of the source image's luminance.\nClip the effect below this luminance value." R 0 4}
  addUserKnob {7 src_white l "src white" t "White point of the source image's luminance." R 0 4}
  src_white 1
  addUserKnob {41 white_clamp l clamp -STARTLINE T Grade1.white_clamp}
  addUserKnob {7 response t "Gamma on the source image's luminance, to change the response curve falloff." R 0 4}
  response 1
  addUserKnob {26 ""}
  addUserKnob {14 max_size l "max size" t "Maximum pixel size of the exponential glow." R 0 10000}
  max_size {{parent.glow_radius.b}}
  addUserKnob {14 falloff l "size falloff" t "Falloff adjustment on the exponential distribution of the blur sizes." R 0 10}
  falloff {{parent.glow_falloff.b}}
  addUserKnob {3 steps t "Number of blur iterations to combine together."}
  steps 10
  addUserKnob {41 filter T Blur.filter}
  addUserKnob {41 quality l "" -STARTLINE T Blur.quality}
  addUserKnob {6 crop l "crop to format" -STARTLINE}
  crop true
  addUserKnob {6 enableOverscan l enable +DISABLED +STARTLINE}
  enableOverscan true
  addUserKnob {14 overscan +DISABLED R 0 1000}
  overscan 100
  addUserKnob {26 ""}
  addUserKnob {41 maskChannelArea l area -STARTLINE T ExpressionArea.maskChannelMask}
  addUserKnob {41 inject_area l inject -STARTLINE T ExpressionArea.inject}
  addUserKnob {41 invert_area l invert -STARTLINE T ExpressionArea.invert_mask}
  addUserKnob {41 fringe_area l fringe -STARTLINE T ExpressionArea.fringe}
  addUserKnob {41 maskChannelMask l mask T Merge.maskChannelMask}
  addUserKnob {41 inject -STARTLINE T Merge.inject}
  addUserKnob {41 invert_mask l invert -STARTLINE T Merge.invert_mask}
  addUserKnob {41 fringe -STARTLINE T Merge.fringe}
  addUserKnob {41 mix T Merge.mix}
  addUserKnob {26 version_author l "" t "apGlow v1.1\n2018" +STARTLINE T "<span style=\"color:#666\"><br/><b>apGlow v1.1</b> - <a href=\"http://www.adrianpueyo.com\" style=\"color:#666;text-decoration: none;\">adrianpueyo.com</a>, 2015-2018</span>"}
 }
  Input {
   inputs 0
   name Inputmask
   xpos -748
   ypos 847
   number 2
  }
  Input {
   inputs 0
   name Inputarea
   xpos -156
   ypos 383
   number 1
  }
  Input {
   inputs 0
   name Inputimg
   xpos -638
   ypos 220
  }
  NoTimeBlur {
   rounding none
   name NTB
   xpos -638
   ypos 267
  }
  Dot {
   name Dot6
   xpos -604
   ypos 308
  }
set Na54dbc00 [stack 0]
  Dot {
   name Dot7
   xpos -384
   ypos 308
  }
set Na54db800 [stack 0]
  Dot {
   name Dot8
   xpos -232
   ypos 308
  }
  Remove {
   name RemoveAll
   xpos -266
   ypos 345
  }
  Expression {
   inputs 1+1
   channel0 rgba
   expr0 1
   name ExpressionArea
   xpos -266
   ypos 383
   disable {{"!\[exists parent.input1]"}}
  }
  Shuffle {
   red white
   green white
   blue white
   alpha white
   name ShuffleWhite
   xpos -266
   ypos 409
   disable {{"\[exists parent.input1]"}}
  }
push $Na54db800
  Remove {
   operation keep
   channels {-rgba.red -rgba.green rgba.blue rgba.alpha}
   name KeepWhat
   xpos -418
   ypos 377
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 apGlowArea.red
   name Copy1
   xpos -418
   ypos 403
   disable {{"!\[exists parent.input1]"}}
  }
  Premult {
   channels all
   alpha apGlowArea.red
   name Premult1
   xpos -418
   ypos 441
   disable {{"!\[exists parent.input1]"}}
  }
  Remove {
   channels apGlowArea
   name RemoveArea
   xpos -418
   ypos 479
   disable {{"!\[exists parent.input1]"}}
  }
  Dot {
   name Dot5
   xpos -384
   ypos 532
  }
set Na54d9400 [stack 0]
  Dot {
   name Dot1
   xpos -284
   ypos 532
  }
  Saturation {
   channels all
   saturation 0
   name Saturation1
   xpos -318
   ypos 572
  }
set Na54d8c00 [stack 0]
  Grade {
   channels all
   blackpoint {{parent.src_black}}
   whitepoint {{parent.src_white}}
   gamma {{parent.response}}
   name Grade1
   xpos -318
   ypos 610
  }
push $Na54d9400
push $Na54d8c00
  Merge2 {
   inputs 2
   operation divide
   also_merge all
   name Merge4
   xpos -418
   ypos 578
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Merge3
   xpos -418
   ypos 616
  }
  Dot {
   name DP
   xpos -384
   ypos 642
   addUserKnob {20 User}
   addUserKnob {14 j R 0 100}
   j {{"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"} {"pow(2, t*(log(parent.max_size*parent.falloff)/log(2)) )"}}
  }
  Blur {
   size {{"DP.j( (t%1)+1/parent.steps) / parent.falloff"} {"DP.j( (t%1)+1/parent.steps) / parent.falloff"}}
   crop false
   name Blur
   xpos -418
   ypos 660
  }
  Multiply {
   value {{"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"} {"parent.persistance * (t%1) + (1-t%1)"}}
   name Multiply
   xpos -418
   ypos 699
  }
  TimeBlur {
   divisions {{parent.steps}}
   shutter 1
   shutteroffset start
   shuttercustomoffset 0
   name TB
   xpos -418
   ypos 736
  }
  Multiply {
   value {{parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0} {parent.steps?parent.intensity*parent.tint:0}}
   name MultiplyR
   xpos -418
   ypos 762
  }
  Expression {
   expr0 isnan(r)?0:r
   expr1 isnan(g)?0:g
   expr2 isnan(b)?0:b
   expr3 isnan(a)?0:a
   name NanToBlack
   xpos -418
   ypos 800
  }
push $Na54dbc00
  Dot {
   name Dot4
   xpos -604
   ypos 582
  }
set Na5482000 [stack 0]
  Dot {
   name Dot2
   xpos -494
   ypos 582
  }
  Shuffle {
   red black
   green black
   blue black
   name Shuffle
   xpos -528
   ypos 660
   disable {{!parent.effect_only}}
  }
  Remove {
   operation keep
   channels rgb
   name Remove1
   xpos -528
   ypos 686
   disable {{!parent.effect_only}}
  }
  Merge2 {
   inputs 2
   operation plus
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge1
   xpos -528
   ypos 800
  }
  Dot {
   name Dot3
   xpos -494
   ypos 850
  }
push $Na5482000
  Merge2 {
   inputs 2+1
   operation copy
   output {rgba.red rgba.green rgba.blue -rgba.alpha}
   also_merge all
   name Merge
   xpos -638
   ypos 846
  }
  Crop {
   box {{parent.crop?0:-parent.overscan} {parent.crop?0:-parent.overscan} {parent.crop?width:width+parent.overscan} {parent.crop?height:height+parent.overscan}}
   intersect true
   name CropOverscan
   xpos -638
   ypos 872
   disable {{"!parent.enableOverscan && !parent.crop"}}
  }
  Output {
   name Output
   xpos -638
   ypos 898
  }
 end_group
 OFXuk.co.thefoundry.furnace.f_regrain_v403 {
  inputs 2
  grainType "Preset Stock"
  presetStock "FUJIF250Under 2K"
  amount 2
  size 1
  output Result
  "Analysis Region" 0
  regionBL {921.5999756 700.1999815}
  regionTR {1126.400024 855.8000185}
  frame 1
  grainColourSpace sRGB
  Advanced 0
  processRed true
  redAmount 1
  redSize 1
  processGreen true
  greenAmount 1
  greenSize 1
  processBlue true
  blueAmount 1
  blueSize 1
  "Grain Response" 0
  srcColourSpace "Grain Colour Space"
  lowGain 0
  midGain 1.5
  highGain 1
  useResponse false
  responseMix 1
  drawResponse false
  needsGrainSample true
  notBeenAnalysed true
  grainClipNeeded true
  inputHasChanged false
  responseR0Counts 0
  responseR0Samples 0
  responseG0Counts 0
  responseG0Samples 0
  responseB0Counts 0
  responseB0Samples 0
  responseR1Counts 0
  responseR1Samples 0
  responseG1Counts 0
  responseG1Samples 0
  responseB1Counts 0
  responseB1Samples 0
  responseR2Counts 0
  responseR2Samples 0
  responseG2Counts 0
  responseG2Samples 0
  responseB2Counts 0
  responseB2Samples 0
  responseR3Counts 0
  responseR3Samples 0
  responseG3Counts 0
  responseG3Samples 0
  responseB3Counts 0
  responseB3Samples 0
  responseR4Counts 0
  responseR4Samples 0
  responseG4Counts 0
  responseG4Samples 0
  responseB4Counts 0
  responseB4Samples 0
  responseR5Counts 0
  responseR5Samples 0
  responseG5Counts 0
  responseG5Samples 0
  responseB5Counts 0
  responseB5Samples 0
  responseR6Counts 0
  responseR6Samples 0
  responseG6Counts 0
  responseG6Samples 0
  responseB6Counts 0
  responseB6Samples 0
  responseR7Counts 0
  responseR7Samples 0
  responseG7Counts 0
  responseG7Samples 0
  responseB7Counts 0
  responseB7Samples 0
  responseR8Counts 0
  responseR8Samples 0
  responseG8Counts 0
  responseG8Samples 0
  responseB8Counts 0
  responseB8Samples 0
  responseR9Counts 0
  responseR9Samples 0
  responseG9Counts 0
  responseG9Samples 0
  responseB9Counts 0
  responseB9Samples 0
  grainSample ""
  cacheBreaker true
  name F_ReGrain1
  xpos -98
  ypos 476
  disable {{parent.grain==0}}
 }
push $Na5310400
 Dot {
  name Dot36
  xpos 68
  ypos 521
 }
 Merge2 {
  inputs 2
  operation plus
  name Merge4
  xpos -98
  ypos 518
 }
 Switch {
  inputs 2
  which {{parent.alpha}}
  name Switch3
  xpos -98
  ypos 643
 }
push $Na5311c00
 Dot {
  name Dot10
  xpos 127
  ypos 4
 }
 Dot {
  name Dot27
  xpos 127
  ypos 704
 }
 Merge2 {
  inputs 2+1
  operation copy
  name Merge1
  xpos -98
  ypos 701
 }
 Shuffle {
  red alpha
  green alpha
  blue alpha
  name Shuffle13
  xpos -97
  ypos 758
  disable {{parent.alpha==0}}
 }
 Output {
  name Output1
  xpos -97
  ypos 815
 }
 StickyNote {
  inputs 0
  name StickyNote3
  label 3
  note_font_size 20
  xpos -1796
  ypos 481
 }
 StickyNote {
  inputs 0
  name StickyNote1
  label 1
  note_font_size 20
  xpos -1526
  ypos 470
 }
 StickyNote {
  inputs 0
  name StickyNote2
  label 2
  note_font_size 20
  xpos -1288
  ypos 455
 }
 NoOp {
  inputs 0
  name NoOp1
  xpos -1361
  ypos 763
  addUserKnob {20 User}
  addUserKnob {7 R_value}
  R_value {{Blur.r}}
  addUserKnob {7 GB_value}
  GB_value {{(Blur.g+Blur.b)/2}}
 }
end_group
